"SCEN_NO","SCEN_NAME","NNO","STEP_TYPE","STEP_NAME","VAR_NAME","LSCHEMA_NAME","VAR_LONG_VALUE","MOD_CODE","TABLE_NAME","RES_NAME","F_CONTEXT_CODE","GLOBAL_ID","GEN_INFO","TASK_TYPE","TASK_TYPE_1","TASK_NAME1","TASK_NAME2","TASK_NAME3","EXE_CHANNEL","DEF_CONTEXT_CODE","COL_LSCHEMA_NAME","COL_TXT","DEF_TXT"
683,"CAPC_LOAD_XACTLY_DATA",0,"VD","Declare CAPC_PROCESS_ID","HYPERION_OPTIMIZATION.CAPC_PROCESS_ID","","","","","","","07c61c09-3127-4943-bb49-805f8397cd06","","V","V","Variable","CAPC_PROCESS_ID","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",1,"VD","Declare LOG_FOLDER","HYPERION_OPTIMIZATION.LOG_FOLDER","","","","","","","b9a93c79-3b98-411e-81d7-3531c5f332b4","","V","V","Variable","LOG_FOLDER","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",2,"VD","Declare TIMESTAMP_SEC","HYPERION_OPTIMIZATION.TIMESTAMP_SEC","","","","","","","3a8f2da6-cb1e-46e1-ae73-fa4ac5820c6b","","V","V","Variable","TIMESTAMP_SEC","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",3,"VD","Declare EBS_PERIOD","HYPERION_OPTIMIZATION.EBS_PERIOD","","AUG-17","","","","","c9de1108-3122-4fe6-aa5d-679a2fb817d0","","V","V","Variable","EBS_PERIOD","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",4,"VD","Declare CAPC_IS_FINAL","HYPERION_OPTIMIZATION.CAPC_IS_FINAL","","","","","","","d5880624-acb2-4c2f-a72b-bcf14a154f26","","V","V","Variable","CAPC_IS_FINAL","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",5,"VD","Declare CAPC_IS_PPP","HYPERION_OPTIMIZATION.CAPC_IS_PPP","","","","","","","4eb15ba2-3202-4189-9f07-22c7b2531c95","","V","V","Variable","CAPC_IS_PPP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",6,"VD","Declare SCENARIO","HYPERION_OPTIMIZATION.SCENARIO","","Xactly_Commissions","","","","","dce70a52-2005-454f-94d8-32b91539bb8d","","V","V","Variable","SCENARIO","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",7,"VD","Declare VERSION","HYPERION_OPTIMIZATION.VERSION","","Final","","","","","7138dd00-62a9-40a8-9fb3-65ec40c988e4","","V","V","Variable","VERSION","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",8,"VD","Declare CAPC_ARCHIVE_SFTP_FILES","HYPERION_OPTIMIZATION.CAPC_ARCHIVE_SFTP_FILES","","Y","","","","","d7acf3d1-e159-418c-b5e6-1d65664498f6","","V","V","Variable","CAPC_ARCHIVE_SFTP_FILES","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",9,"VE","Is Final = Y?","HYPERION_OPTIMIZATION.CAPC_IS_FINAL","","Y","","","","","61129707-63be-488e-8aaa-1cb0e697a139","","V","V","Variable","CAPC_IS_FINAL","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",10,"VE","Is PPP = Y? (i.e. Final - PPP)","HYPERION_OPTIMIZATION.CAPC_IS_PPP","","Y","","","","","609b08b0-4643-4c16-b745-181804ac962a","","V","V","Variable","CAPC_IS_PPP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",11,"VS","Set CAPC_DATA_SOURCE_TYPE = FINAL+PPP","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE","","Xactly_Final_ALF_PPP","","","","","ed9ec250-5068-48f2-9409-0fe3f70841f0","","V","V","Variable","CAPC_DATA_SOURCE_TYPE","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",12,"V","Refresh CAPC_COMMISSION_PERIOD","HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD","","","","","","","7c26f8fa-e2ca-4a2e-8561-93540f4c946f","","V","V","Variable","CAPC_COMMISSION_PERIOD","","","","","","SELECT TO_CHAR( Add_Months( '01-#HYPERION_OPTIMIZATION.EBS_PERIOD' , -1 ) , 'MON-yy' ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",13,"VS","Set INT_NAME = Xactly","HYPERION_OPTIMIZATION.INT_NAME","","Xactly","","","","","b0cf2ab5-69ee-485a-9e15-c212898ce7a4","","V","V","Variable","INT_NAME","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",14,"T","Determine ALF File Name","","","","","","","","925f4e8f-aeee-48d6-9ef4-9d3b2f3cd5ca","","S","S","Procedure","Determine File Name","Write File Name to File","B","","","","import os
# directory where files are SFTP'd
strXactlySftpDir = ""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>""
# Pattern of file name to search for (file name needs to start with this/contain this text)
strFilePattern = ""#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE"" + ""_#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD""
# strFilePattern = ""Xactly_Final_ALF_Comm_JUL-17""
# file to which to write the file name to so that a variable can be initialized based on this value
strVariableFile = ""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/CAPC_DATA_SOURCE_ID.txt""
# strVariableFile = ""//sfm-hypn-wd008/d$/Hyperion/HyperionFiles/CapComm/audit/CAPC_DATA_SOURCE_ID.txt""

blnFoundFile = False
for objFile in os.listdir(strXactlySftpDir):
    if strFilePattern in objFile and objFile.endswith("".done"") and not blnFoundFile:
        objVariableFile = open( strVariableFile , ""w"" )
        # objVariableFile.write(os.path.join(strXactlySftpDir, objFile))
        strFileName = """" + objFile
        if 1 == 1:
            strFileName = strFileName[:(len(strFileName) - len("".done""))]
        objVariableFile.write( strFileName )
        objVariableFile.close()
        blnFoundFile = True

# if no file found: raise exception to terminate the process
if blnFoundFile == False:
    strMessage = ""There are no (more) files to process with file name containing '"" + strFilePattern + ""' and extension '.done'""
    strMessage += ""\n(Target folder: "" + strXactlySftpDir + "")""
    raise Exception(""\n\n"" + strMessage + ""\n\n"")"
683,"CAPC_LOAD_XACTLY_DATA",15,"V","Refresh CAPC_DATA_SOURCE_ID","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID","","Xactly_Final_ALF_Comm_JUN_17_2017OCT16_145000.txt","","","","","68bec345-221a-4c27-9c28-8ae57c5c6315","","V","V","Variable","CAPC_DATA_SOURCE_ID","","","","","","select	FILE_NAME	C1_FILE_NAME
from 	TABLE

/*$$SNPS_START_KEYSNP$CRDWG_TABLESNP$CRTABLE_NAME=FILE_NAMESNP$CRLOAD_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""w"") ?>\audit\CAPC_DATA_SOURCE_ID.txtSNP$CRFILE_FORMAT=DSNP$CRFILE_SEP_FIELD=0x0009SNP$CRFILE_SEP_LINE=0x000D0x000ASNP$CRFILE_FIRST_ROW=0SNP$CRFILE_ENC_FIELD=SNP$CRFILE_DEC_SEP=SNP$CRSNP$CRDWG_COLSNP$CRCOL_NAME=FILE_NAMESNP$CRTYPE_NAME=STRINGSNP$CRORDER=1SNP$CRLENGTH=100SNP$CRPRECISION=100SNP$CR$$SNPS_END_KEY*/"
683,"CAPC_LOAD_XACTLY_DATA",16,"V","Refresh HYP_PERIOD","HYPERION_OPTIMIZATION.HYP_PERIOD","","","","","","","7aca8bec-2c53-4455-b180-a549ad367900","","V","V","Variable","HYP_PERIOD","","","","","","SELECT SubStr( '#HYPERION_OPTIMIZATION.EBS_PERIOD' , 1 , 3 ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",17,"V","Refresh HYP_YEAR","HYPERION_OPTIMIZATION.HYP_YEAR","","","","","","","f08ae6c7-88db-48f5-8356-282a0c6f8cdc","","V","V","Variable","HYP_YEAR","","","","","","SELECT 'FY' || ( SubStr( '#HYPERION_OPTIMIZATION.EBS_PERIOD' , -2 ) + 
CASE 
    WHEN Upper( SubStr( '#HYPERION_OPTIMIZATION.EBS_PERIOD' , 1 , 3 ) ) = 'JAN' 
    THEN 0
    ELSE 1
END)
FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",18,"T","Send START Email to IT-Hyperion","","","","","","","","0dea5945-c740-4c88-a518-77da044314be","","S","S","Procedure","Send START Email to IT-Hyperion","Send START Email","S","","","","OdiSendMail ""-MAILHOST=#GLOBAL.SFDC_EMAIL_SERVER"" ""-FROM=#GLOBAL.SFDC_EMAIL_ADMIN"" ""-SUBJECT=ODI STARTED: <?=odiRef.getSession(""SESS_NAME"") ?> (SessionID: <?=odiRef.getSession(""SESS_NO"") ?>) - Context: <?=odiRef.getContext(""CTX_NAME"") ?>"" ""-TO=#GLOBAL.SFDC_EPM_EMAIL_LIST""

FYI
===

ODI Process has been started to process the dataset for #HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE
Period: #HYPERION_OPTIMIZATION.EBS_PERIOD"
683,"CAPC_LOAD_XACTLY_DATA",19,"V","Refresh CAPCOMM_ROOT_FOLDER","HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER","","","","","","","7813941f-44af-48c7-b0c0-00130bd98c03","","V","V","Variable","CAPCOMM_ROOT_FOLDER","","","","","","SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",20,"V","Refresh CAPCOMM_AUDIT_FILE","HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE","","","","","","","be5e9955-fc54-4563-b323-52b3e617b3cc","","V","V","Variable","CAPCOMM_AUDIT_FILE","","","","","","SELECT '#HYPERION_OPTIMIZATION.LOG_FOLDER/audit_<?=odiRef.getSession(""SESS_NAME"") ?>_#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",21,"SE","CAPC_EXTRACT_DRIVERS v1","","","","","","","","49a3b549-25d1-421a-8aa3-9cc9ad7bca6a","","S","S","Oracle Data Integrator Command","Oracle Data Integrator Command","","S","","","","OdiStartScen ""-SCEN_NAME=CAPC_EXTRACT_DRIVERS"" ""-SCEN_VERSION=001"" ""-HYPERION_OPTIMIZATION.TIMESTAMP_SEC=#HYPERION_OPTIMIZATION.TIMESTAMP_SEC"" ""-HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE=#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE"" ""-HYPERION_OPTIMIZATION.LOG_FOLDER=#HYPERION_OPTIMIZATION.LOG_FOLDER"" ""-HYPERION_OPTIMIZATION.EBS_PERIOD=#HYPERION_OPTIMIZATION.EBS_PERIOD"""
683,"CAPC_LOAD_XACTLY_DATA",22,"V","MNA_ORG62CODE","HYPERION_OPTIMIZATION.MNA_ORG62CODE","","","","","","","9b1b5192-1247-4238-b3c0-ce2919774bdb","","V","V","Variable","MNA_ORG62CODE","","","","","","SELECT CONCAT(CONCAT('''',(SELECT LISTAGG (ORG62CODE,''',''' )  WITHIN GROUP (ORDER BY MNA_DRIVER) FROM 
            T_CAPC_ORG62CODE_TO_EG WHERE EBS_PERIOD='#HYPERION_OPTIMIZATION.EBS_PERIOD')),'''') MNA_CODES FROM DUAL"
683,"CAPC_LOAD_XACTLY_DATA",23,"V","MNA_SUBCLOUD","HYPERION_OPTIMIZATION.MNA_SUBCLOUD","","","","","","","8f516c3c-cb39-4783-8fc9-2e342f4f1448","","V","V","Variable","MNA_SUBCLOUD","","","","","","SELECT CONCAT(CONCAT('''',(SELECT LISTAGG (SUBCLOUD,''',''' )  WITHIN GROUP (ORDER BY MNA_DRIVER) FROM 
            T_CAPC_SUBCLOUD_TO_EG WHERE EBS_PERIOD='#HYPERION_OPTIMIZATION.EBS_PERIOD')),'''') MNA_CODES FROM DUAL"
683,"CAPC_LOAD_XACTLY_DATA",24,"V","RENEWAL_EG","HYPERION_OPTIMIZATION.RENEWAL_EG","","","","","","","80c11860-ae01-49cc-b07a-026ad9718f09","","V","V","Variable","RENEWAL_EG","","","","","","SELECT CONCAT(CONCAT('''',(SELECT LISTAGG (CHILD,''',''' )  WITHIN GROUP (ORDER BY PARENT) FROM V_CAPCOMM_EARNINGGROUP WHERE PARENT='Renewal_Contracts')),'''') RENEWAL_CONTRACTS FROM DUAL"
683,"CAPC_LOAD_XACTLY_DATA",25,"V","CAPCOMM_ROOT_FOLDER","HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER","","","","","","","a16e3bde-1b7a-48f4-a590-1f9d85230e38","","V","V","Variable","CAPCOMM_ROOT_FOLDER","","","","","","SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",26,"V","EG_MS_CODES","HYPERION_OPTIMIZATION.EG_MS_CODES","","","","","","","dc5ff3d5-5e0e-40c2-b7f4-86af12061bf5","","V","V","Variable","EG_MS_CODES","","","","","","SELECT CONCAT(CONCAT('''',(SELECT LISTAGG (EARNINGS_GROUP,''',''' )  WITHIN GROUP (ORDER BY ACCOUNT) FROM 
            T_CAPC_DRIVERS WHERE ACCOUNT='Exception_Earninggroups' AND GL_PERIOD='#HYPERION_OPTIMIZATION.EBS_PERIOD')),'''') EXCEPTION_EG FROM DUAL"
683,"CAPC_LOAD_XACTLY_DATA",27,"V","MS_BLENDED_PERCENT","HYPERION_OPTIMIZATION.MS_BLENDED_PERCENT","","","","","","","285aea5a-77a2-4a3e-8c15-8a937b564127","","V","V","Variable","MS_BLENDED_PERCENT","","","","","","SELECT DISTINCT CAP_PERCENT FROM T_CAPC_SUBCLOUD_TO_EG WHERE EBS_PERIOD='#HYPERION_OPTIMIZATION.EBS_PERIOD' AND MNA_DRIVER = 'MuleSoft_Blended'"
683,"CAPC_LOAD_XACTLY_DATA",28,"VD","CAPC_EG_CAP","HYPERION_OPTIMIZATION.CAPC_EG_CAP","","","","","","","37f109f6-76b6-4193-9d19-3f7b3ffcf867","","V","V","Variable","CAPC_EG_CAP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",29,"VD","CAPC_EG_EXP","HYPERION_OPTIMIZATION.CAPC_EG_EXP","","","","","","","ffd62108-14ec-420e-b2e8-3f68f27c51e9","","V","V","Variable","CAPC_EG_EXP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",30,"VD","Declare CAPC_EMAIL_ATTACHMENTS","HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS","","","","","","","8068693e-e68a-4cc7-87b7-9442a0414b54","","V","V","Variable","CAPC_EMAIL_ATTACHMENTS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",31,"VD","Declare CAPC_EMAIL_LINKS","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS","","","","","","","eb39b3f7-cda1-4f50-bf0c-ec3c163c030e","","V","V","Variable","CAPC_EMAIL_LINKS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",32,"VD","CAPC_ERROR_FILE_DETAILED_V1","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1","","","","","","","a42efeb9-41bb-4335-a9bd-d51623821694","","V","V","Variable","CAPC_ERROR_FILE_DETAILED_V1","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",33,"VD"," CAPC_EMAIL_LINKS_V1","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1","","","","","","","da15ac3f-6d13-46ca-a67d-3fd706a82cd5","","V","V","Variable","CAPC_EMAIL_LINKS_V1","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",34,"T","Delete Xactly Prelim Records","","","","","","","","5c543f36-007f-445f-890f-7f1879898b66","","S","S","Procedure","Delete Xactly Prelim Records","show variables","B","","","","raise Exception(""gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD' AND '#HYPERION_OPTIMIZATION.CAPC_IS_FINAL' = 'Y'"")"
683,"CAPC_LOAD_XACTLY_DATA",34,"T","Delete Xactly Prelim Records","","","","","","","","5c543f36-007f-445f-890f-7f1879898b66","","S","S","Procedure","Delete Xactly Prelim Records","DELETE Xactly Inbound","J","","","","DELETE FROM t_capc_xactly_inbound
WHERE data_source_type LIKE '%Prelim%'
AND gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
/* W-8244105
AND '#HYPERION_OPTIMIZATION.CAPC_IS_FINAL' = 'Y'*/"
683,"CAPC_LOAD_XACTLY_DATA",34,"T","Delete Xactly Prelim Records","","","","","","","","5c543f36-007f-445f-890f-7f1879898b66","","S","S","Procedure","Delete Xactly Prelim Records","DELETE Xactly STG1","J","","","","DELETE FROM t_capc_xactly_stg1
WHERE data_source_type LIKE '%Prelim%'
AND ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
/* W-8244105
AND '#HYPERION_OPTIMIZATION.CAPC_IS_FINAL' = 'Y'*/"
683,"CAPC_LOAD_XACTLY_DATA",34,"T","Delete Xactly Prelim Records","","","","","","","","5c543f36-007f-445f-890f-7f1879898b66","","S","S","Procedure","Delete Xactly Prelim Records","DELETE Xactly STG2","J","","","","DELETE FROM t_capc_xactly_stg2
WHERE data_source_type LIKE '%Prelim%'
AND ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
/* W-8244105
AND '#HYPERION_OPTIMIZATION.CAPC_IS_FINAL' = 'Y'*/"
683,"CAPC_LOAD_XACTLY_DATA",34,"T","Delete Xactly Prelim Records","","","","","","","","5c543f36-007f-445f-890f-7f1879898b66","","S","S","Procedure","Delete Xactly Prelim Records","DELETE Xactly from Dataload","J","","","","DELETE FROM t_capc_dataload
WHERE data_source_type LIKE '%Prelim%'
AND gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
/* W-8244105
AND '#HYPERION_OPTIMIZATION.CAPC_IS_FINAL' = 'Y'*/"
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","MAP_MAIN","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","ORA_HYPGL_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete errors from controlled table","CKM Oracle - FTI","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>  T
where	exists 	(
		select	1
		from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?> E
		where ODI_SESS_NO = <?=odiRef.getSession(""SESS_NO"") ?>
		and T.rowid = E.ODI_ROW_ID
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create error table","CKM Oracle - FTI","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_ROW_ID 		UROWID,
	ODI_ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL, 
	ODI_ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL, 
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	PRODUCT_NAME	VARCHAR2(255) NULL,
	PRODUCT_SKU	VARCHAR2(100) NULL,
	PRODUCT_LIST_PRICE	VARCHAR2(100) NULL,
	AMOUNT	VARCHAR2(100) NULL,
	NUM_SEATS	VARCHAR2(100) NULL,
	COMPENSATION_CATEGORY	VARCHAR2(100) NULL,
	PRODUCT_FAMILY	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	ORDER_SUB_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	RELATED_CONTRACT_NUMBER	VARCHAR2(100) NULL,
	RELATED_ITEM_CODE	VARCHAR2(100) NULL,
	RELATED_ORDER_CODE	VARCHAR2(255) NULL,
	ATTRITION_FISCAL_YEAR	VARCHAR2(100) NULL,
	CONTRACT_START_DATE	VARCHAR2(100) NULL,
	ORDER_START_DATE	VARCHAR2(100) NULL,
	ORDER_END_DATE	VARCHAR2(100) NULL,
	ORIGINAL_CONTRACT_END_DATE	VARCHAR2(100) NULL,
	ACV_END_DATE	VARCHAR2(100) NULL,
	RENEWAL_START_DATE	VARCHAR2(100) NULL,
	AMOUNT_UNIT_TYPE	VARCHAR2(100) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(100) NULL,
	PAYMENT_CURRENCY	VARCHAR2(100) NULL,
	BUSINESS_GROUP_EX_RATE	VARCHAR2(100) NULL,
	PAYMENT_EX_RATE	VARCHAR2(100) NULL,
	ITEM_PAYMENT_EX_RATE	VARCHAR2(100) NULL,
	IS_REDUCTION_ORDER	VARCHAR2(100) NULL,
	COMMISSION_AMOUNT	VARCHAR2(100) NULL,
	COMMISSION_PERIOD	VARCHAR2(100) NULL,
	INCENTIVE_DATE	VARCHAR2(100) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(100) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP	VARCHAR2(100) NULL,
	MAN_CALC_REASON_CODE	VARCHAR2(100) NULL,
	ROLE	VARCHAR2(100) NULL,
	COMMISSION_CURRENCY	VARCHAR2(100) NULL,
	REVENUE_OWNER	VARCHAR2(512) NULL,
	ORDER_DESCRIPTION	VARCHAR2(1024) NULL,
	SUBCLOUD	VARCHAR2(100) NULL,
	ORG62CODE	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	GL_PERIOD	VARCHAR2(100) NULL,
	SCENARIO	VARCHAR2(100) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL,
	ODI_ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ODI_CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	ODI_CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ODI_PK			<?=odiRef.getDataType(""DEST_VARCHAR"", ""32"") ?> PRIMARY KEY,
	ODI_SESS_NO		<?=odiRef.getDataType(""DEST_VARCHAR"", ""19"") ?>
)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create index on error table","CKM Oracle - FTI","","J","","ORA_HYPGL",""," 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
create index 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
on	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?> (ODI_ROW_ID)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Remove ""control"" file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.ctl"" -NOFILE_ERROR=no
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Drop Work View","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","drop view <?= odiRef.getObjectName(""L"", ""%COL_PRF0ALF"", ""W"") ?>  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Remove ""bad"" file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.bad"" -NOFILE_ERROR=no  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Drop Temp table","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","drop table <?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"") ?>    "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Remove ""out"" file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.out""  -NOFILE_ERROR=no
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_PERIOD cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'COMMISSION_PERIOD',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	COMMISSION_PERIOD is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create check table","CKM Oracle - FTI","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	CATALOG_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	SCHEMA_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	RESOURCE_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	FULL_RES_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL,
	ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL ,
	CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL,
	ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ERR_COUNT		<?=odiRef.getDataType(""DEST_NUMERIC"", ""10"") ?> NULL
)
	  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_AMOUNT cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'COMMISSION_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	COMMISSION_AMOUNT is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous check sum","CKM Oracle - FTI","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
where	SCHEMA_NAME	= '<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>'
and	ORIGIN 		= '(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table'
and	ERR_TYPE 		= 'F'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Commit transaction","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","/* commit */ "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","delete from 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table')
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert new rows","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
insert into	<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_INBOUND"", ""ORA_HYPGL"", ""D"") ?> 
( 
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
) 
select	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert flow into I$ table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","insert into	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select 	
	ALF_A.ORDER_CODE,
	ALF_A.ORDER_ITEM_ID,
	ALF_A.CEO_NUMBER,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( ALF_A.ACCOUNT_NUMBER , CONVERT( ALF_A.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , ALF_A.ACCOUNT_NUMBER , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( ALF_A.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	Replace(Convert(to_Char(dbms_lob.SubStr(ALF_A.CUSTOMER_NAME,255,1 )), 'US7ASCII', 'UTF8'), '?' , ''),
	ALF_A.CONTRACT_NUMBER,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( ALF_A.PRODUCT_NAME , CONVERT( ALF_A.PRODUCT_NAME , 'US7ASCII' , 'UTF8' ) , ALF_A.PRODUCT_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( ALF_A.PRODUCT_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	ALF_A.PRODUCT_SKU,
	ALF_A.PRODUCT_LIST_PRICE,
	ALF_A.AMOUNT,
	ALF_A.NUM_SEATS,
	ALF_A.COMPENSATION_CATEGORY,
	ALF_A.PRODUCT_FAMILY,
	ALF_A.ORDER_TYPE,
	ALF_A.ORDER_SUB_TYPE,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( ALF_A.BATCH_NAME , CONVERT( ALF_A.BATCH_NAME , 'US7ASCII' , 'UTF8' ) , ALF_A.BATCH_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( ALF_A.BATCH_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	ALF_A.RELATED_CONTRACT_NUMBER,
	ALF_A.RELATED_ITEM_CODE,
	ALF_A.RELATED_ORDER_CODE,
	ALF_A.ATTRITION_FISCAL_YEAR,
	ALF_A.CONTRACT_START_DATE,
	ALF_A.ORDER_START_DATE,
	ALF_A.ORDER_END_DATE,
	ALF_A.ORIGINAL_CONTRACT_END_DATE,
	ALF_A.ACV_END_DATE,
	ALF_A.RENEWAL_START_DATE,
	ALF_A.AMOUNT_UNIT_TYPE,
	ALF_A.BUSINESS_GROUP_CURRENCY,
	ALF_A.PAYMENT_CURRENCY,
	ALF_A.BUSINESS_GROUP_EX_RATE,
	ALF_A.PAYMENT_EX_RATE,
	ALF_A.ITEM_PAYMENT_EX_RATE,
	ALF_A.IS_REDUCTION_ORDER,
	ALF_A.COMMISSION_AMOUNT,
	ALF_A.COMMISSION_PERIOD,
	ALF_A.INCENTIVE_DATE,
	ALF_A.BUSINESS_GROUP,
	ALF_A.DEPARTMENT_NUMBER,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( ALF_A.PARTICIPANT_NAME , CONVERT( ALF_A.PARTICIPANT_NAME , 'US7ASCII' , 'UTF8' ) , ALF_A.PARTICIPANT_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( ALF_A.PARTICIPANT_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	ALF_A.SFDC_EMPLOYEE_ID,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( ALF_A.POSITION_NAME , CONVERT( ALF_A.POSITION_NAME , 'US7ASCII' , 'UTF8' ) , ALF_A.POSITION_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( ALF_A.POSITION_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	CASE
    WHEN ALF_A.EARNING_GROUP IS NULL THEN NULL
    ELSE 'EG_' || ALF_A.EARNING_GROUP
END,
	CASE
    WHEN ALF_A.MAN_CALC_REASON_CODE IS NULL THEN NULL
    ELSE 'EG_' || ALF_A.MAN_CALC_REASON_CODE
END,
	CASE
    WHEN ALF_A.ROLE IS NULL THEN NULL
    ELSE 'R_' || ALF_A.ROLE
END,
	ALF_A.COMMISSION_CURRENCY,
	ALF_A.REVENUE_OWNER,
	ALF_A.ORDER_DESCRIPTION,
	ALF_A.SUBCLOUD,
	ALF_A.ORG62CODE,
	#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID,
	'#HYPERION_OPTIMIZATION.EBS_PERIOD',
	'#HYPERION_OPTIMIZATION.SCENARIO',
	'#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE',
	'#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID',
	sysdate,
	rownum /* ALF_A.AMOUNT */
from	<?= odiRef.getObjectName(""L"", ""%COL_PRF0ALF"", ""ORA_HYPGL"", ""W"") ?> ALF_A
where	
	(1=1)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Delete target table - SELECTIVELY","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","delete from <?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_INBOUND"", ""ORA_HYPGL"", ""D"") ?>
/* added to original IKM: */
WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_id = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID'   "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column SFDC_EMPLOYEE_ID cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'SFDC_EMPLOYEE_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	SFDC_EMPLOYEE_ID is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column EARNING_GROUP cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'EARNING_GROUP',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	EARNING_GROUP is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","drop error table","CKM Oracle - FTI","","J","","ORA_HYPGL","","
drop table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert check sum into check table","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>',
	'T_CAPC_XACTLY_INBOUND',
	'<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_INBOUND"", ""ORA_HYPGL"", ""D"") ?>',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?> E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column PAYMENT_CURRENCY cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'PAYMENT_CURRENCY',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	PAYMENT_CURRENCY is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column ROLE cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'ROLE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	ROLE is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Create flow table I$","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","create table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	PRODUCT_NAME	VARCHAR2(255) NULL,
	PRODUCT_SKU	VARCHAR2(100) NULL,
	PRODUCT_LIST_PRICE	VARCHAR2(100) NULL,
	AMOUNT	VARCHAR2(100) NULL,
	NUM_SEATS	VARCHAR2(100) NULL,
	COMPENSATION_CATEGORY	VARCHAR2(100) NULL,
	PRODUCT_FAMILY	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	ORDER_SUB_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	RELATED_CONTRACT_NUMBER	VARCHAR2(100) NULL,
	RELATED_ITEM_CODE	VARCHAR2(100) NULL,
	RELATED_ORDER_CODE	VARCHAR2(255) NULL,
	ATTRITION_FISCAL_YEAR	VARCHAR2(100) NULL,
	CONTRACT_START_DATE	VARCHAR2(100) NULL,
	ORDER_START_DATE	VARCHAR2(100) NULL,
	ORDER_END_DATE	VARCHAR2(100) NULL,
	ORIGINAL_CONTRACT_END_DATE	VARCHAR2(100) NULL,
	ACV_END_DATE	VARCHAR2(100) NULL,
	RENEWAL_START_DATE	VARCHAR2(100) NULL,
	AMOUNT_UNIT_TYPE	VARCHAR2(100) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(100) NULL,
	PAYMENT_CURRENCY	VARCHAR2(100) NULL,
	BUSINESS_GROUP_EX_RATE	VARCHAR2(100) NULL,
	PAYMENT_EX_RATE	VARCHAR2(100) NULL,
	ITEM_PAYMENT_EX_RATE	VARCHAR2(100) NULL,
	IS_REDUCTION_ORDER	VARCHAR2(100) NULL,
	COMMISSION_AMOUNT	VARCHAR2(100) NULL,
	COMMISSION_PERIOD	VARCHAR2(100) NULL,
	INCENTIVE_DATE	VARCHAR2(100) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(100) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP	VARCHAR2(100) NULL,
	MAN_CALC_REASON_CODE	VARCHAR2(100) NULL,
	ROLE	VARCHAR2(100) NULL,
	COMMISSION_CURRENCY	VARCHAR2(100) NULL,
	REVENUE_OWNER	VARCHAR2(512) NULL,
	ORDER_DESCRIPTION	VARCHAR2(1024) NULL,
	SUBCLOUD	VARCHAR2(100) NULL,
	ORG62CODE	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	GL_PERIOD	VARCHAR2(100) NULL,
	SCENARIO	VARCHAR2(100) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL
)  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'Invalid Date: check CONTRACT_START / ORDER_START / ORDER_END / COMMISSION_PERIOD',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'INVALID_DATE_FORMAT',
	'CK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>  T_CAPC_XACTLY_INBOUND
where	not 	(
		f_Check_Date( T_CAPC_XACTLY_INBOUND.CONTRACT_START_DATE , 'mm/dd/yyyy hh24:mi' , 'dd-MON-yy' ) NOT LIKE 'INVALID%'
AND f_Check_Date( T_CAPC_XACTLY_INBOUND.ORDER_START_DATE , 'mm/dd/yyyy hh24:mi' , 'dd-MON-yy' ) NOT LIKE 'INVALID%'
AND f_Check_Date( T_CAPC_XACTLY_INBOUND.ORDER_END_DATE , 'mm/dd/yyyy hh24:mi' , 'dd-MON-yy' ) NOT LIKE 'INVALID%'
AND f_Check_Date( T_CAPC_XACTLY_INBOUND.COMMISSION_PERIOD , 'mm/dd/yyyy hh24:mi' , 'dd-MON-yy' ) NOT LIKE 'INVALID%'
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column PAYMENT_EX_RATE cannot be null.',
	sysdate,
	'(24)Hyperion_Optimization.TXT_ORA Load ALF to Xactly Inbound Table',
	'PAYMENT_EX_RATE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_START_DATE,
	ORDER_END_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	REVENUE_OWNER,
	ORDER_DESCRIPTION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	GL_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_INBOUND"", ""W"") ?>
where	PAYMENT_EX_RATE is null
AND order_item_id NOT LIKE 'Number of records generated: %'
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","FILE_CAPCOMM_SFTP_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Create Work View","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","create view <?= odiRef.getObjectName(""L"", ""%COL_PRF0ALF"", ""W"") ?>
(
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	PRODUCT_NAME,
	PRODUCT_SKU,
	PRODUCT_LIST_PRICE,
	AMOUNT,
	NUM_SEATS,
	COMPENSATION_CATEGORY,
	PRODUCT_FAMILY,
	ORDER_TYPE,
	ORDER_SUB_TYPE,
	BATCH_NAME,
	RELATED_CONTRACT_NUMBER,
	RELATED_ITEM_CODE,
	RELATED_ORDER_CODE,
	ATTRITION_FISCAL_YEAR,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	ORIGINAL_CONTRACT_END_DATE,
	ACV_END_DATE,
	RENEWAL_START_DATE,
	AMOUNT_UNIT_TYPE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	BUSINESS_GROUP_EX_RATE,
	PAYMENT_EX_RATE,
	ITEM_PAYMENT_EX_RATE,
	IS_REDUCTION_ORDER,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	INCENTIVE_DATE,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	MAN_CALC_REASON_CODE,
	ROLE,
	COMMISSION_CURRENCY,
	ORDER_DESCRIPTION,
	REVENUE_OWNER,
	SUBCLOUD,
	ORG62CODE
) as
select	
	ALF.ORDER_CODE	 ORDER_CODE,
	ALF.ORDER_ITEM_ID	 ORDER_ITEM_ID,
	ALF.CEO_NUMBER	 CEO_NUMBER,
	ALF.ACCOUNT_NUMBER	 ACCOUNT_NUMBER,
	ALF.CUSTOMER_NAME	 CUSTOMER_NAME,
	ALF.CONTRACT_NUMBER	 CONTRACT_NUMBER,
	ALF.PRODUCT_NAME	 PRODUCT_NAME,
	ALF.PRODUCT_SKU	 PRODUCT_SKU,
	ALF.PRODUCT_LIST_PRICE	 PRODUCT_LIST_PRICE,
	ALF.AMOUNT	 AMOUNT,
	ALF.NUM_SEATS	 NUM_SEATS,
	ALF.COMPENSATION_CATEGORY	 COMPENSATION_CATEGORY,
	ALF.PRODUCT_FAMILY	 PRODUCT_FAMILY,
	ALF.ORDER_TYPE	 ORDER_TYPE,
	ALF.ORDER_SUB_TYPE	 ORDER_SUB_TYPE,
	ALF.BATCH_NAME	 BATCH_NAME,
	ALF.RELATED_CONTRACT_NUMBER	 RELATED_CONTRACT_NUMBER,
	ALF.RELATED_ITEM_CODE	 RELATED_ITEM_CODE,
	ALF.RELATED_ORDER_CODE	 RELATED_ORDER_CODE,
	ALF.ATTRITION_FISCAL_YEAR	 ATTRITION_FISCAL_YEAR,
	ALF.CONTRACT_START_DATE	 CONTRACT_START_DATE,
	ALF.ORDER_END_DATE	 ORDER_END_DATE,
	ALF.ORDER_START_DATE	 ORDER_START_DATE,
	ALF.ORIGINAL_CONTRACT_END_DATE	 ORIGINAL_CONTRACT_END_DATE,
	ALF.ACV_END_DATE	 ACV_END_DATE,
	ALF.RENEWAL_START_DATE	 RENEWAL_START_DATE,
	ALF.AMOUNT_UNIT_TYPE	 AMOUNT_UNIT_TYPE,
	ALF.BUSINESS_GROUP_CURRENCY	 BUSINESS_GROUP_CURRENCY,
	ALF.PAYMENT_CURRENCY	 PAYMENT_CURRENCY,
	ALF.BUSINESS_GROUP_EX_RATE	 BUSINESS_GROUP_EX_RATE,
	ALF.PAYMENT_EX_RATE	 PAYMENT_EX_RATE,
	ALF.ITEM_PAYMENT_EX_RATE	 ITEM_PAYMENT_EX_RATE,
	ALF.IS_REDUCTION_ORDER	 IS_REDUCTION_ORDER,
	ALF.COMMISSION_AMOUNT	 COMMISSION_AMOUNT,
	ALF.COMMISSION_PERIOD	 COMMISSION_PERIOD,
	ALF.INCENTIVE_DATE	 INCENTIVE_DATE,
	ALF.BUSINESS_GROUP	 BUSINESS_GROUP,
	ALF.DEPARTMENT_NUMBER	 DEPARTMENT_NUMBER,
	ALF.PARTICIPANT_NAME	 PARTICIPANT_NAME,
	ALF.SFDC_EMPLOYEE_ID	 SFDC_EMPLOYEE_ID,
	ALF.POSITION_NAME	 POSITION_NAME,
	ALF.EARNING_GROUP	 EARNING_GROUP,
	ALF.MAN_CALC_REASON_CODE	 MAN_CALC_REASON_CODE,
	ALF.ROLE	 ROLE,
	ALF.COMMISSION_CURRENCY	 COMMISSION_CURRENCY,
	ALF.ORDER_DESCRIPTION	 ORDER_DESCRIPTION,
	ALF.REVENUE_OWNER	 REVENUE_OWNER,
	ALF.SUBCLOUD	 SUBCLOUD,
	ALF.ORG62CODE	 ORG62CODE
from	<?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"") ?>  ALF
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Drop Temp table","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","drop table <?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"") ?>   "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Gather statistics","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","
BEGIN
DBMS_STATS.GATHER_TABLE_STATS (
    ownname =>	'<?= odiRef.getInfo(""DEST_WORK_SCHEMA"") ?>',
    tabname =>	'<?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"").replaceAll(odiRef.getInfo( ""DEST_WORK_SCHEMA"" )+""."","""")?>',
    estimate_percent =>	DBMS_STATS.AUTO_SAMPLE_SIZE
);
END;
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Call sqlldr","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","B","","FILE_CAPCOMM_SFTP","","import java.lang.String
import java.lang.Runtime as Runtime
from jarray import array
import java.io.File
import os
import re
def reportnbrows():		
	f = open(r""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.log"", 'r') 
	try:
		for line in f.readlines():
			if line.find(""MAXIMUM ERROR COUNT EXCEEDED"")>=0 :
				raise  ""MAXIMUM ERROR COUNT EXCEEDED"", ""See %s for details"" % logfile
	finally:
		f.close() 
ctlfile = r""""""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.ctl""""""
logfile = r""""""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.log""""""
outfile = r""""""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.out""""""
oracle_sid=''
if len('<?= odiRef.getInfo(""DEST_DSERV_NAME"") ?>')>0: oracle_sid = '@'+'<?= odiRef.getInfo(""DEST_DSERV_NAME"") ?>'
<? { /* single quote needs to be escaped on UNIX systems */ sq = System.getProperty(""file.separator"").equals(""/"") ? ""\'"" : ""'""; ?>
loadcmd = r""""""sqlldr <?=sq?><?= odiRef.getInfo(""DEST_USER_NAME"") ?>/<?= odiRef.getInfo(""DEST_PASS"") ?>%s<?=sq?> control=<?=sq?>%s<?=sq?> log=<?=sq?>%s<?=sq?> > ""%s"" READSIZE=1048576"""""" % (oracle_sid,ctlfile, logfile, outfile)
<?}?>
rc = os.system(loadcmd)
if rc <> 0 and rc <> 2:
        raise ""Load Error"", ""See %s for details"" % logfile
if rc==2:
        reportnbrows()  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Generate CTL file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","<?
package com.oracle.odi.km.ext;
public class FormatTranslator {
	// Java Date Formatting information available at http://java.sun.com/j2se/1.4.2/docs/api/java/text/SimpleDateFormat.html
	// Oracle Date Formatting information available in Oracle SQL Language Reference: Chapter ""Basic Elements fo Oracle SQL"": DateTime Format Elements
	static String[][] transTableDate = {
	    {""y"",		""Y""},	// Year, supported:  yyyy;yy => 1996;96
	    {""MMMM(M)*"",	""month""},	// Month, supported: MMMM => July
	    {""MMM"",		""mon""},	// Month, supported: MMM => JUL
	    {""M"",		""M""},	// Month, supported: MM;M => 07;7
	    {""month"",		""MONTH""},	// (auxiliary)
	    {""mon"",		""MON""},	// (auxiliary)
	    {""W"",		""W""},	// Week in month
	    {""w"",		""WW""},	// Week in year 
	    {""DDD"",		""DDD""},	// Day in year 
	    {""dd"",		""DD""},	// Day in month
	    {""a"",		""AM""},	// Am/pm marker 
	    {""HH"",		""HH24""},	// Hour in day (0-23)
	    {""KK"",		""HH12""},	// Hour in day (0-11)
	    {""mm"",		""MI""},	// Minute in hour 
	    {""SSSSSS"",	""FF6""},	// Millisecond in second 
	    {""SSSSS"",		""FF5""},	// Millisecond in second 
	    {""SSSS"",		""FF4""},	// Millisecond in second 
	    {""SSS"",		""FF3""},	// Millisecond in second 
	    {""SS"",		""FF2""},	// Millisecond in second 
	    {""S"",		""FF1""},	// Millisecond in second 
	    {""ss"",		""SS""},	// Second in minute 
	    {""Z"",		""TZH:TZM""}	// Timezone, supported: Z => +02:00
	};	   
	public static String translate( String srcDT, String colFormat ) throws Exception {
		String format = """";
		if (colFormat.trim().length()==0) 
			/* we use Oracle's default format */
			format = """";
		else {
			// Is source column a date?
			if ( srcDT.toUpperCase().equals( ""DATE"") ) {
				format = colFormat;
				for (int i = 0; i < transTableDate.length; i++)
					format = format.replaceAll( transTableDate[i][0], transTableDate[i][1] );
			} else 
			// Is source column a numeric?
			if ( srcDT.toUpperCase().equals( ""NUMERIC"")) {
				format = """";
			} else 
			// Is source column anything else than a string?
			if ( !srcDT.toUpperCase().equals( ""STRING"" )) 
				throw new Exception(""No format translation defined for data type ""+srcDT+""!""); 
		};
		if ( format.length() > 0 )
			format = format;
		return format;
	}
}
public class sqlldrColFormat {
	public static String	nlsDateLanguage = """"; 
	public static boolean	enforceNlsNumChars = false; 
	public static String	nlsNumChars = ""NLS_NUMERIC_CHARACTERS=''''"";
	public static String get( String colName, srcDataType, destDataType, colFormat, colPrecision, colScale ) {
		String format = """";
		String oracleDataFormat = FormatTranslator.translate( srcDataType, colFormat );
		// Is the source column a DATE?
		if (""DATE"".equals(srcDataType)) { 
			dataType = """";
			dataConvFunc = """";
			// How many digits are there for milliseconds?
			int precision = colFormat.replaceAll(""[^S]"","""").length();
			// Does the source column contain a timezone?
			if (colFormat.indexOf(""Z"")>-1) {
				if (precision > 0) {
					dataType = ""TIMESTAMP("" + precision.toString() + "") WITH TIME ZONE"";
				} else {
					dataType = ""TIMESTAMP WITH TIME ZONE"";
				};
				dataConvFunc = ""TO_TIMESTAMP_TZ"";
			// Does the source column contain milliseconds?
			} else if (precision > 0) {
				dataType = ""TIMESTAMP("" + precision.toString() + "")""; 
				dataConvFunc = ""TO_TIMESTAMP""; 
			// Okay, it's just a normal date!
			} else {
				dataType = ""DATE"";
				dataConvFunc = ""TO_DATE"";
			};
			// Does the source column contain a language specifc element and has a date language been specified?
			if ((colFormat.indexOf(""MMM"")>-1 ||
			    colFormat.indexOf(""a"")>-1) &&
			    nlsDateLanguage.length()>0) {
				// Explicit conversion function required
				format = "" ""+(char)34+dataConvFunc+""(:""+colName+"", '""+oracleDataFormat+""', '""+nlsDateLanguage+""')""+(char)34;
			} else {
				// Is there a column format defined for this column?
				if (colFormat.length()>0) {
					// Implicit conversion by date_format clause
					format = "" ""+dataType+"" ""+(char)34+oracleDataFormat+(char)34;
				} else {
					// Use client nls settings to convert date/timestamp
					format = """";
				};
			};
		} else
		// Is the source column a NUMERIC?
		if (""NUMERIC"".equals(srcDataType)) {
			// Do we need to enforce NLS settings for numbers?
			if (enforceNlsNumChars) {
				precision = new Integer(colPrecision).intValue();
				scale = new Integer(colScale).intValue();
				// Build a number format according to precision and scale
				digitsInFront = precision - ((scale==0)?0:(scale + 1));
				digitsBehind = scale;
				if (digitsInFront < 0)
					throw new Exception(""Column "" + colName +"": Scale > Precision is not supported! Please correct precision/scale!""); 
				format = "" ""+(char)34+""TO_NUMBER(:""+colName+"", '"";
				format += ""99999999999999999999999999999999999999"".substring(0,digitsInFront);
				if (digitsBehind>0) {
					format += ""D"";
					format += ""99999999999999999999999999999999999999"".substring(0,digitsBehind);
				};
				format += ""', '""+nlsNumChars+""')""+(char)34;
			} else {
				format = ""DECIMAL EXTERNAL"";
			};
		} else {
		// The source column is a STRING => add char(length) for length greater than 255
			taille = new Integer(colPrecision).intValue(); 
			if (taille > 254) 
			format = ""CHAR(""+colPrecision+"")"";
			else 
			format ="""";
		};
		return format;
	}
}
public static String stringToHex(String base)
    {
     StringBuffer buffer = new StringBuffer();
     int intValue;
     for(int x = 0; x < base.length(); x++)
         {
         intValue = base.charAt(x);
         buffer.append(Integer.toHexString(intValue));
     }
     return buffer.toString();
}
?>SnpsOutFile ""-File=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.ctl"" ""-CHARSET_ENCODING=ISO8859-1""
OPTIONS (
	SKIP=1,
	ERRORS=0,
	DIRECT=FALSE
	, PARALLEL=TRUE
	)
LOAD DATA
INFILE ""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""D"") ?>/<?= odiRef.getObjectShortName(""L"", ""#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID.txt"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>"" ""STR x'0A'""
BADFILE ""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.bad""
DISCARDFILE ""<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""D"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.dsc""
DISCARDMAX 1
INTO TABLE <?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"") ?>
APPEND
FIELDS TERMINATED BY X'5E5E'
TRAILING NULLCOLS
(
	ORDER_CODE	<?=sqlldrColFormat.get(""ORDER_CODE"",""STRING"", ""VARCHAR2"", """", ""255"", """")?>,
	ORDER_ITEM_ID	<?=sqlldrColFormat.get(""ORDER_ITEM_ID"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	CEO_NUMBER	<?=sqlldrColFormat.get(""CEO_NUMBER"",""STRING"", ""VARCHAR2"", """", ""255"", """")?>,
	ACCOUNT_NUMBER	<?=sqlldrColFormat.get(""ACCOUNT_NUMBER"",""STRING"", ""VARCHAR2"", """", ""4000"", """")?>,
	CUSTOMER_NAME	<?=sqlldrColFormat.get(""CUSTOMER_NAME"",""STRING"", ""CLOB"", """", ""10000"", """")?>,
	CONTRACT_NUMBER	<?=sqlldrColFormat.get(""CONTRACT_NUMBER"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PRODUCT_NAME	<?=sqlldrColFormat.get(""PRODUCT_NAME"",""STRING"", ""VARCHAR2"", """", ""4000"", """")?>,
	PRODUCT_SKU	<?=sqlldrColFormat.get(""PRODUCT_SKU"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PRODUCT_LIST_PRICE	<?=sqlldrColFormat.get(""PRODUCT_LIST_PRICE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	AMOUNT	<?=sqlldrColFormat.get(""AMOUNT"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	NUM_SEATS	<?=sqlldrColFormat.get(""NUM_SEATS"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	COMPENSATION_CATEGORY	<?=sqlldrColFormat.get(""COMPENSATION_CATEGORY"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PRODUCT_FAMILY	<?=sqlldrColFormat.get(""PRODUCT_FAMILY"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORDER_TYPE	<?=sqlldrColFormat.get(""ORDER_TYPE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORDER_SUB_TYPE	<?=sqlldrColFormat.get(""ORDER_SUB_TYPE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	BATCH_NAME	<?=sqlldrColFormat.get(""BATCH_NAME"",""STRING"", ""VARCHAR2"", """", ""4000"", """")?>,
	RELATED_CONTRACT_NUMBER	<?=sqlldrColFormat.get(""RELATED_CONTRACT_NUMBER"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	RELATED_ITEM_CODE	<?=sqlldrColFormat.get(""RELATED_ITEM_CODE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	RELATED_ORDER_CODE	<?=sqlldrColFormat.get(""RELATED_ORDER_CODE"",""STRING"", ""VARCHAR2"", """", ""255"", """")?>,
	ATTRITION_FISCAL_YEAR	<?=sqlldrColFormat.get(""ATTRITION_FISCAL_YEAR"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	CONTRACT_START_DATE	<?=sqlldrColFormat.get(""CONTRACT_START_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORDER_END_DATE	<?=sqlldrColFormat.get(""ORDER_END_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORDER_START_DATE	<?=sqlldrColFormat.get(""ORDER_START_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORIGINAL_CONTRACT_END_DATE	<?=sqlldrColFormat.get(""ORIGINAL_CONTRACT_END_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ACV_END_DATE	<?=sqlldrColFormat.get(""ACV_END_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	RENEWAL_START_DATE	<?=sqlldrColFormat.get(""RENEWAL_START_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	AMOUNT_UNIT_TYPE	<?=sqlldrColFormat.get(""AMOUNT_UNIT_TYPE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	BUSINESS_GROUP_CURRENCY	<?=sqlldrColFormat.get(""BUSINESS_GROUP_CURRENCY"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PAYMENT_CURRENCY	<?=sqlldrColFormat.get(""PAYMENT_CURRENCY"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	BUSINESS_GROUP_EX_RATE	<?=sqlldrColFormat.get(""BUSINESS_GROUP_EX_RATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PAYMENT_EX_RATE	<?=sqlldrColFormat.get(""PAYMENT_EX_RATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ITEM_PAYMENT_EX_RATE	<?=sqlldrColFormat.get(""ITEM_PAYMENT_EX_RATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	IS_REDUCTION_ORDER	<?=sqlldrColFormat.get(""IS_REDUCTION_ORDER"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	COMMISSION_AMOUNT	<?=sqlldrColFormat.get(""COMMISSION_AMOUNT"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	COMMISSION_PERIOD	<?=sqlldrColFormat.get(""COMMISSION_PERIOD"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	INCENTIVE_DATE	<?=sqlldrColFormat.get(""INCENTIVE_DATE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	BUSINESS_GROUP	<?=sqlldrColFormat.get(""BUSINESS_GROUP"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	DEPARTMENT_NUMBER	<?=sqlldrColFormat.get(""DEPARTMENT_NUMBER"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	PARTICIPANT_NAME	<?=sqlldrColFormat.get(""PARTICIPANT_NAME"",""STRING"", ""VARCHAR2"", """", ""4000"", """")?>,
	SFDC_EMPLOYEE_ID	<?=sqlldrColFormat.get(""SFDC_EMPLOYEE_ID"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	POSITION_NAME	<?=sqlldrColFormat.get(""POSITION_NAME"",""STRING"", ""VARCHAR2"", """", ""4000"", """")?>,
	EARNING_GROUP	<?=sqlldrColFormat.get(""EARNING_GROUP"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	MAN_CALC_REASON_CODE	<?=sqlldrColFormat.get(""MAN_CALC_REASON_CODE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ROLE	<?=sqlldrColFormat.get(""ROLE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	COMMISSION_CURRENCY	<?=sqlldrColFormat.get(""COMMISSION_CURRENCY"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORDER_DESCRIPTION	<?=sqlldrColFormat.get(""ORDER_DESCRIPTION"",""STRING"", ""VARCHAR2"", """", ""1024"", """")?>,
	REVENUE_OWNER	<?=sqlldrColFormat.get(""REVENUE_OWNER"",""STRING"", ""VARCHAR2"", """", ""512"", """")?>,
	SUBCLOUD	<?=sqlldrColFormat.get(""SUBCLOUD"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>,
	ORG62CODE	<?=sqlldrColFormat.get(""ORG62CODE"",""STRING"", ""VARCHAR2"", """", ""100"", """")?>
)
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Create Temp table","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","create table <?=odiRef.getObjectName(""T%COL_PRF0ALF"", ""W"") ?>
(
ORDER_CODE VARCHAR2(255),
ORDER_ITEM_ID VARCHAR2(100),
CEO_NUMBER VARCHAR2(255),
ACCOUNT_NUMBER VARCHAR2(4000),
CUSTOMER_NAME CLOB,
CONTRACT_NUMBER VARCHAR2(100),
PRODUCT_NAME VARCHAR2(4000),
PRODUCT_SKU VARCHAR2(100),
PRODUCT_LIST_PRICE VARCHAR2(100),
AMOUNT VARCHAR2(100),
NUM_SEATS VARCHAR2(100),
COMPENSATION_CATEGORY VARCHAR2(100),
PRODUCT_FAMILY VARCHAR2(100),
ORDER_TYPE VARCHAR2(100),
ORDER_SUB_TYPE VARCHAR2(100),
BATCH_NAME VARCHAR2(4000),
RELATED_CONTRACT_NUMBER VARCHAR2(100),
RELATED_ITEM_CODE VARCHAR2(100),
RELATED_ORDER_CODE VARCHAR2(255),
ATTRITION_FISCAL_YEAR VARCHAR2(100),
CONTRACT_START_DATE VARCHAR2(100),
ORDER_END_DATE VARCHAR2(100),
ORDER_START_DATE VARCHAR2(100),
ORIGINAL_CONTRACT_END_DATE VARCHAR2(100),
ACV_END_DATE VARCHAR2(100),
RENEWAL_START_DATE VARCHAR2(100),
AMOUNT_UNIT_TYPE VARCHAR2(100),
BUSINESS_GROUP_CURRENCY VARCHAR2(100),
PAYMENT_CURRENCY VARCHAR2(100),
BUSINESS_GROUP_EX_RATE VARCHAR2(100),
PAYMENT_EX_RATE VARCHAR2(100),
ITEM_PAYMENT_EX_RATE VARCHAR2(100),
IS_REDUCTION_ORDER VARCHAR2(100),
COMMISSION_AMOUNT VARCHAR2(100),
COMMISSION_PERIOD VARCHAR2(100),
INCENTIVE_DATE VARCHAR2(100),
BUSINESS_GROUP VARCHAR2(100),
DEPARTMENT_NUMBER VARCHAR2(100),
PARTICIPANT_NAME VARCHAR2(4000),
SFDC_EMPLOYEE_ID VARCHAR2(100),
POSITION_NAME VARCHAR2(4000),
EARNING_GROUP VARCHAR2(100),
MAN_CALC_REASON_CODE VARCHAR2(100),
ROLE VARCHAR2(100),
COMMISSION_CURRENCY VARCHAR2(100),
ORDER_DESCRIPTION VARCHAR2(1024),
REVENUE_OWNER VARCHAR2(512),
SUBCLOUD VARCHAR2(100),
ORG62CODE VARCHAR2(100)
)
NOLOGGING  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Drop work view","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","J","","FILE_CAPCOMM_SFTP","","drop view <?= odiRef.getObjectName(""L"", ""%COL_PRF0ALF"", ""W"") ?>
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","MAP_CLEANUP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","FILE_CAPCOMM_SFTP_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Remove ""log"" file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.log""  -NOFILE_ERROR=no
  "
683,"CAPC_LOAD_XACTLY_DATA",35,"M","TXT_ORA Load ALF to Xactly Inbound Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_INBOUND","T_CAPC_XACTLY_INBOUND","","7085efc7-24b1-4e02-9003-69fe8d24af9a","<map-generation-info>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""gl_period = '#EBS_PERIOD'&#xa;AND data_source_id = '#CAPC_DATA_SOURCE_ID'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""false""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""CKM"" km=""CKM Oracle - FTI.Hyperion_Optimization"">
      <option name=""IGNORE_ERROR_CONDITION"" value=""order_item_id NOT LIKE 'Number of records generated: %'"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""ALF_AP"" type=""LKM"" km=""LKM File to Oracle (SQLLDR) - FTI - PARALLEL.Hyperion_Optimization"">
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WORK_TABLE_OPTIONS"" value=""NOLOGGING"" default=""true""/>
      <option name=""LOA_DIRECT"" value=""FALSE"" default=""true""/>
      <option name=""LOA_DISCARDMAX"" value=""1"" default=""true""/>
      <option name=""LOA_ERRORS"" value=""0"" default=""false""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""NLS_DATE_LANGUAGE"" value="""" default=""true""/>
      <option name=""NLS_NUMERIC_CHARACTERS"" value="""" default=""true""/>
      <option name=""CHARSET_ENCODING"" value=""ISO8859-1"" default=""true""/>
      <option name=""READSIZE"" value=""1048576"" default=""true""/>
   </node>
   <node name=""ALF"" type=""XKM"" km=""XKM SQL File Extract.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_INBOUND"" resource=""T_CAPC_XACTLY_INBOUND"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","C","C","Remove ""discard"" file","LKM File to Oracle (SQLLDR) - FTI - PARALLEL","","S","","FILE_CAPCOMM_SFTP","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/<?= odiRef.getObjectShortName(""L"", ""XACTLY_ALF_COMM"", ""FILE_CAPCOMM_SFTP"", ""D"") ?>.dsc""  -NOFILE_ERROR=no
  "
683,"CAPC_LOAD_XACTLY_DATA",36,"T","Check Transfer to Inbound","","","","","","","","847d060b-f800-4c08-886e-5540f9c86de2","","S","S","Procedure","Check Processed Records","Capture Validation Detail","J","","ORA_EBS_SFDC_CAPCOM","","BEGIN

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, SOURCE_RECORDS)
SELECT DISTINCT data_source_type, data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '0 - SOURCE DATA' process_step, Sum( Replace( order_item_id , 'Number of records generated: ' , '' ) ) source_records 
FROM t_capc_xactly_inbound
WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
AND order_code LIKE 'Period: ' || Replace('#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD','-','-20') || '%'
AND order_item_id LIKE 'Number of records generated: %'
AND ceo_number LIKE 'Sum of Payments: %'
GROUP BY data_source_type, data_source_id, gl_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, INSERTED_RECORDS)
SELECT DISTINCT data_source_type, data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '1 - TXT_ORA' process_step, Count(*) inserted_records 
FROM t_capc_xactly_inbound
WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
AND NOT ( order_code LIKE 'Period: ' || Replace('#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD','-','-20') || '%'
AND order_item_id LIKE 'Number of records generated: %'
AND ceo_number LIKE 'Sum of Payments: %' )
GROUP BY data_source_type, data_source_id, gl_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, INSERTED_RECORDS)
SELECT data_source_type, data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, payment_currency, '1 - TXT_ORA' process_step
, Sum(commission_amount * payment_ex_rate) inserted_records
FROM t_capc_xactly_inbound
WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
AND NOT ( order_code LIKE 'Period: ' || Replace('#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD','-','-20') || '%'
AND order_item_id LIKE 'Number of records generated: %'
AND ceo_number LIKE 'Sum of Payments: %' )
GROUP BY data_source_type, data_source_id, gl_period, payment_currency;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '2 - TXT_ORA Error' process_step
, Count(Distinct odi_row_id) ERROR_RECORDS, null WARNING_RECORDS
FROM e$_t_capc_xactly_inbound
WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, gl_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, payment_currency, '2 - TXT_ORA Error' process_step
, Sum(commission_amount * payment_ex_rate) ERROR_RECORDS, null WARNING_RECORDS FROM (
  SELECT DISTINCT odi_row_id, data_source_type, data_source_id, scenario, gl_period, SubStr(payment_currency, -3) payment_currency, commission_amount, payment_ex_rate
  FROM e$_t_capc_xactly_inbound
  WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
  AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
) GROUP BY data_source_type, data_source_id, scenario, gl_period, payment_currency;

EXCEPTION
    WHEN OTHERS THEN
        INSERT INTO t_capc_audits (gl_period, odi_process_id, data_source_type, scenario, status)
        VALUES ('#HYPERION_OPTIMIZATION.EBS_PERIOD', #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE', '#HYPERION_OPTIMIZATION.SCENARIO', '2 - ERROR: Validation Report is Invalid');

END;"
683,"CAPC_LOAD_XACTLY_DATA",36,"T","Check Transfer to Inbound","","","","","","","","847d060b-f800-4c08-886e-5540f9c86de2","","S","S","Procedure","Check Processed Records","Write Information to Audit File","B","","","","
blnCompleted = False
try:
	objAuditFile = None # need to create variable, needed below in case of failure to open
	objAuditFile = open( '#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE' , 'a' )
	objAuditFile.write(""Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>\n"")
	objAuditFile.write(""* StartTime: <?=odiRef.getPrevStepLog(""BEGIN"") ?>\n"")
	objAuditFile.write(""* EndTime: <?=odiRef.getPrevStepLog(""End"") ?>\n"")
	objAuditFile.write(""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) + ""\n"")


	objAuditFile.write(""Number of Deletes: "" + str(<?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?>) + ""\n"")

	objAuditFile.write(""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) + ""\n"")
	objAuditFile.write(""\n"")
	objAuditFile.write(""-   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -\n"")
	blnCompleted = True
finally:
	if not objAuditFile is None:
		objAuditFile.close()
	if not blnCompleted:
		raise Exception( ""\n\nError encountered with Audit file: #HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE\n"" )

"
683,"CAPC_LOAD_XACTLY_DATA",36,"T","Check Transfer to Inbound","","","","","","","","847d060b-f800-4c08-886e-5540f9c86de2","","S","S","Procedure","Check Processed Records","Check for Inserted Records","B","","","","if <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> > 0:
	print( ""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>)
		+ ""\n\t(expected Number of Inserts > 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",36,"T","Check Transfer to Inbound","","","","","","","","847d060b-f800-4c08-886e-5540f9c86de2","","S","S","Procedure","Check Processed Records","Check for Error Records","B","","","","if <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> == 0:
	print( ""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>)
		+ ""\n\t(expected Number of Errors == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",36,"T","Check Transfer to Inbound","","","","","","","","847d060b-f800-4c08-886e-5540f9c86de2","","S","S","Procedure","Check Processed Records","Set Stats","B","","","","odiRef.setNbInsert( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> )
odiRef.setNbErrors( <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )
odiRef.setNbRows( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> + <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )"
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","MAP_MAIN","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","ORA_HYPGL_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'Capitalized Non-Pooled OrderStartDate in Future',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'Non-Pooled OrderStartDate in Future',
	'CK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>  T_CAPC_XACTLY_STG1
where	not 	(
		NOT (
    T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE = #HYPERION_OPTIMIZATION.CAPC_EG_CAP
    AND T_CAPC_XACTLY_STG1.ROLE_POOLED = #HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED
    AND TO_DATE( T_CAPC_XACTLY_STG1.ORDER_START_DATE , 'dd-MON-yy' ) >= TO_DATE( '16-#HYPERION_OPTIMIZATION.EBS_PERIOD' , 'dd-MON-yy' )
    AND T_CAPC_XACTLY_STG1.EBS_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
    AND T_CAPC_XACTLY_STG1.DATA_SOURCE_TYPE = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
)
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Commit transaction","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","/* commit */ "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete errors from controlled table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>  T
where	exists 	(
		select	1
		from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> E
		where ODI_SESS_NO = <?=odiRef.getSession(""SESS_NO"") ?>
		and T.rowid = E.ODI_ROW_ID
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15065: Join error (Employee MISSING in Workday) between the table T_CAPC_XACTLY_STG1 and the table V_WORKDAY_EMPLOYEES_LATEST_COA.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'Employee MISSING in Workday',
	'FK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> T_CAPC_XACTLY_STG1 
where 	(
		T_CAPC_XACTLY_STG1.SFDC_EMPLOYEE_ID 
	) not in 	(
		select 	EMPLOYEE_ID
		from 	<?= odiRef.getObjectName(""L"", ""V_WORKDAY_EMPLOYEES_LATEST_COA"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_XACTLY_STG1.SFDC_EMPLOYEE_ID is not null 
	)
/* BEGIN - custom filter added by M. Heilos, FinTech Innovations */
and NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #HYPERION_OPTIMIZATION.CAPC_EG_EXP */
/* END - custom filter added by M. Heilos, FinTech Innovations */   "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous check sum","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
where	SCHEMA_NAME	= '<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>'
and	ORIGIN 		= '(25)Hyperion_Optimization.ORA Transform Xactly STG1'
and	ERR_TYPE 		= 'F'
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","delete from 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(25)Hyperion_Optimization.ORA Transform Xactly STG1')
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert new rows","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
insert into	<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG1"", ""ORA_HYPGL"", ""D"") ?> 
( 
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
) 
select	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column RUN_DATE cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'RUN_DATE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	RUN_DATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Delete target table - SELECTIVELY","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","delete from <?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG1"", ""ORA_HYPGL"", ""D"") ?>
/* added to original IKM: */
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'   "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create check table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	CATALOG_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	SCHEMA_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	RESOURCE_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	FULL_RES_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL,
	ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL ,
	CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL,
	ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ERR_COUNT		<?=odiRef.getDataType(""DEST_NUMERIC"", ""10"") ?> NULL
)
	  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15065: Join error (EarningsGroup MISSING in Planning) between the table T_CAPC_XACTLY_STG1 and the table V_CAPCOMMZ_EARNINGGROUP.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'EarningsGroup MISSING in Planning',
	'FK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> T_CAPC_XACTLY_STG1 
where 	(
		T_CAPC_XACTLY_STG1.EARNING_GROUP 
	) not in 	(
		select 	CHILD
		from 	<?= odiRef.getObjectName(""L"", ""V_CAPCOMM_EARNINGGROUP"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_XACTLY_STG1.EARNING_GROUP is not null 
	)
/* BEGIN - custom filter added by M. Heilos, FinTech Innovations */
and NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #HYPERION_OPTIMIZATION.CAPC_EG_EXP */
/* END - custom filter added by M. Heilos, FinTech Innovations */   "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column EG_CAPITAL_EXPENSE cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'EG_CAPITAL_EXPENSE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	EG_CAPITAL_EXPENSE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_TYPE cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'DATA_SOURCE_TYPE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	DATA_SOURCE_TYPE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert check sum into check table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>',
	'T_CAPC_XACTLY_STG1',
	'<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG1"", ""ORA_HYPGL"", ""D"") ?>',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(25)Hyperion_Optimization.ORA Transform Xactly STG1'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create index on error table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL",""," 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
create index 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
on	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> (ODI_ROW_ID)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create error table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_ROW_ID 		UROWID,
	ODI_ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL, 
	ODI_ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL, 
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	CONTRACT_START_DATE	VARCHAR2(20) NULL,
	ORDER_END_DATE	VARCHAR2(20) NULL,
	ORDER_START_DATE	VARCHAR2(20) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_EX_RATE	VARCHAR2(50) NULL,
	COMMISSION_AMOUNT_INPUT	VARCHAR2(50) NULL,
	COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	COMMISSION_PERIOD	VARCHAR2(20) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(80) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP_INPUT	VARCHAR2(100) NULL,
	MAN_CALC_REASON_CODE	VARCHAR2(100) NULL,
	EARNING_GROUP	VARCHAR2(80) NULL,
	ROLE_INPUT	VARCHAR2(100) NULL,
	ROLE	VARCHAR2(80) NULL,
	COMMISSION_CURRENCY	VARCHAR2(20) NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(20) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	ROLE_CATCHUP_MONTHS	NUMBER NULL,
	PPP_CATCHUP_MONTHS	NUMBER NULL,
	TOTAL_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_START_PERIOD	VARCHAR2(100) NULL,
	COMMISSION_AMOUNT_ORGINAL	VARCHAR2(100) NULL,
	EXPENSE_COMMISSION	VARCHAR2(100) NULL,
	SUBCLOUD	VARCHAR2(100) NULL,
	ORG62CODE	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	EBS_PERIOD	VARCHAR2(20) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL,
	ODI_ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ODI_CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	ODI_CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ODI_PK			<?=odiRef.getDataType(""DEST_VARCHAR"", ""32"") ?> PRIMARY KEY,
	ODI_SESS_NO		<?=odiRef.getDataType(""DEST_VARCHAR"", ""19"") ?>
)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column EARNING_GROUP cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'EARNING_GROUP',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	EARNING_GROUP is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'Capitalized, Pooled Role does not have Pooled Classification and/or Catchup Months defined',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'ROLE_UNMAPPED_FOR_CAPITALIZED',
	'CK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>  T_CAPC_XACTLY_STG1
where	not 	(
		/* Capitalized, Pooled Records need to have PooledClassification and Catchup Months - otherwise these fields can be empty; note: NVL(..., 'x') makes sure null is treated as well */
CASE
    WHEN NVL(T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE, 'x') != '#HYPERION_OPTIMIZATION.CAPC_EG_EXP' /* if not Expense, i.e. if Capital or undefined */
      AND NVL(T_CAPC_XACTLY_STG1.ROLE_POOLED, 'x') != '#HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED' /* if not Non-Pooled, i.e. if Pooled or undefined */
    THEN
        CASE
            WHEN T_CAPC_XACTLY_STG1.ROLE_POOLED IS NOT NULL 
              AND T_CAPC_XACTLY_STG1.ROLE_CATCHUP_MONTHS IS NOT NULL
            THEN 1 /* 1 indicates success */
            ELSE 0 /* 0 indicates constraint violation */
        END
    ELSE 1
END = 1
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_AMOUNT cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'COMMISSION_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	COMMISSION_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert flow into I$ table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","insert into	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select 	
	T_CAPC_XACTLY_INBOUND.ORDER_CODE,
	T_CAPC_XACTLY_INBOUND.ORDER_ITEM_ID,
	T_CAPC_XACTLY_INBOUND.CEO_NUMBER,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( T_CAPC_XACTLY_INBOUND.ACCOUNT_NUMBER , CONVERT( T_CAPC_XACTLY_INBOUND.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_INBOUND.ACCOUNT_NUMBER , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( T_CAPC_XACTLY_INBOUND.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 100 ),
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( T_CAPC_XACTLY_INBOUND.CUSTOMER_NAME , CONVERT( T_CAPC_XACTLY_INBOUND.CUSTOMER_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_INBOUND.CUSTOMER_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( T_CAPC_XACTLY_INBOUND.CUSTOMER_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	T_CAPC_XACTLY_INBOUND.CONTRACT_NUMBER,
	T_CAPC_XACTLY_INBOUND.ORDER_TYPE,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( T_CAPC_XACTLY_INBOUND.BATCH_NAME , CONVERT( T_CAPC_XACTLY_INBOUND.BATCH_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_INBOUND.BATCH_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( T_CAPC_XACTLY_INBOUND.BATCH_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	TO_CHAR( TO_DATE( T_CAPC_XACTLY_INBOUND.CONTRACT_START_DATE , 'mm/dd/yyyy hh24:mi' ) , 'dd-MON-yy' ),
	TO_CHAR( TO_DATE( T_CAPC_XACTLY_INBOUND.ORDER_END_DATE , 'mm/dd/yyyy hh24:mi' ) , 'dd-MON-yy' ),
	CASE 
WHEN T_CAPC_XACTLY_INBOUND.ORG62CODE IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) AND DRIVER_ROLE_POOLED.DRIVER_VALUE = '#HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED' 
THEN TO_CHAR( TO_DATE( NVL(T_CAPC_XACTLY_INBOUND.ORDER_START_DATE,T_CAPC_XACTLY_INBOUND.INCENTIVE_DATE) , 'mm/dd/yyyy hh24:mi' ) , 'dd-MON-yy' ) 
ELSE TO_CHAR( TO_DATE( T_CAPC_XACTLY_INBOUND.ORDER_START_DATE , 'mm/dd/yyyy hh24:mi' ) , 'dd-MON-yy' ) 
END,
	T_CAPC_XACTLY_INBOUND.BUSINESS_GROUP_CURRENCY,
	T_CAPC_XACTLY_INBOUND.PAYMENT_CURRENCY,
	T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE,
	T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT,
	CASE  
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.ORG62CODE IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP NOT IN (#HYPERION_OPTIMIZATION.RENEWAL_EG) 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE * T_CAPC_ORG62CODE_TO_EG.CAP_PERCENT 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.ORG62CODE IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP IN (#HYPERION_OPTIMIZATION.RENEWAL_EG) 
THEN 0 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP IN (#HYPERION_OPTIMIZATION.EG_MS_CODES) AND T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE * T_CAPC_EXCEPTION_EG.DRIVER_VALUE 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND (T_CAPC_XACTLY_INBOUND.ORG62CODE NOT IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) OR T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL) 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_EXP' 
THEN 0 
END,
	TO_CHAR( TO_DATE( T_CAPC_XACTLY_INBOUND.COMMISSION_PERIOD , 'mm/dd/yyyy hh24:mi' ) , 'dd-MON-yy' ),
	T_CAPC_XACTLY_INBOUND.BUSINESS_GROUP,
	T_CAPC_XACTLY_INBOUND.DEPARTMENT_NUMBER,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( T_CAPC_XACTLY_INBOUND.PARTICIPANT_NAME , CONVERT( T_CAPC_XACTLY_INBOUND.PARTICIPANT_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_INBOUND.PARTICIPANT_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( T_CAPC_XACTLY_INBOUND.PARTICIPANT_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	T_CAPC_XACTLY_INBOUND.SFDC_EMPLOYEE_ID,
	SubStrB( /* to clear string if it contains non-ASCII chars:
Decode( T_CAPC_XACTLY_INBOUND.POSITION_NAME , CONVERT( T_CAPC_XACTLY_INBOUND.POSITION_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_INBOUND.POSITION_NAME , '' ) */
/* to replace non-ASCII chars with '?': */
Replace(Replace( CONVERT( T_CAPC_XACTLY_INBOUND.POSITION_NAME , 'US7ASCII', 'UTF8') , '?' , '' ),'""', '') , 1 , 255 ),
	T_CAPC_XACTLY_INBOUND.EARNING_GROUP,
	T_CAPC_XACTLY_INBOUND.MAN_CALC_REASON_CODE,
	CASE
    WHEN T_CAPC_XACTLY_INBOUND.EARNING_GROUP = '#HYPERION_OPTIMIZATION.CAPC_EG_MANUAL_CALCULATION'
    THEN T_CAPC_XACTLY_INBOUND.MAN_CALC_REASON_CODE
    ELSE T_CAPC_XACTLY_INBOUND.EARNING_GROUP
END,
	T_CAPC_XACTLY_INBOUND.ROLE,
	T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE,
	T_CAPC_XACTLY_INBOUND.COMMISSION_CURRENCY,
	DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE,
	CASE
    WHEN Upper( T_CAPC_XACTLY_INBOUND.EARNING_GROUP ) LIKE 'EG%RENEWAL%'
      AND Upper( T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE ) IN ( 'R_AE' , 'R_AE MANAGER' )
    THEN #HYPERION_OPTIMIZATION.CAPC_ROLE_POOLED
    ELSE DRIVER_ROLE_POOLED.DRIVER_VALUE
END,
	CASE
    WHEN Upper( T_CAPC_XACTLY_INBOUND.EARNING_GROUP ) LIKE 'EG%RENEWAL%'
      AND Upper( T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE ) IN ( 'R_AE' , 'R_AE MANAGER' )
    THEN 2
    ELSE DRIVER_ROLE_CATCHUP.DRIVER_VALUE
END,
	CASE
	WHEN T_CAPC_XACTLY_INBOUND.SCENARIO = '#HYPERION_OPTIMIZATION.CAPC_XACTLY_PPP' THEN
		CASE
			WHEN
				CASE
    WHEN Upper( T_CAPC_XACTLY_INBOUND.EARNING_GROUP ) LIKE 'EG%RENEWAL%'
      AND Upper( T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE ) IN ( 'R_AE' , 'R_AE MANAGER' )
    THEN 'Exception'
    ELSE 'regular'
END 
				/*CASE
					WHEN Upper( T_CAPC_XACTLY_INBOUND.EARNING_GROUP ) LIKE 'EG%RENEWAL%'
					AND Upper( T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE ) IN ( 'R_AE' , 'R_AE MANAGER' )
					THEN 'Exception' --$(overrideValue)
					ELSE 'regular' --$(defaultValue)
				END*/ = 'Exception'
			THEN 0
			WHEN DRIVER_ROLE_POOLED.DRIVER_VALUE = #HYPERION_OPTIMIZATION.CAPC_ROLE_POOLED		
			THEN Ceil(
				MONTHS_BETWEEN(
					TO_DATE( '01-#HYPERION_OPTIMIZATION.EBS_PERIOD' , 'dd-MON-yy' )
					, TO_DATE( T_CAPC_XACTLY_INBOUND.COMMISSION_PERIOD , 'mm/dd/yyyy hh24:mi' )
				)
			)
			ELSE 0
		END	
	ELSE 0
END,
	CASE
    WHEN Upper( T_CAPC_XACTLY_INBOUND.EARNING_GROUP ) LIKE 'EG%RENEWAL%'
      AND Upper( T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE ) IN ( 'R_AE' , 'R_AE MANAGER' )
    THEN '#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD'
    ELSE null
END,
	T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE,
	CASE  
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.ORG62CODE IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP NOT IN (#HYPERION_OPTIMIZATION.RENEWAL_EG) 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE * (1 - T_CAPC_ORG62CODE_TO_EG.CAP_PERCENT) 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.ORG62CODE IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP IN (#HYPERION_OPTIMIZATION.RENEWAL_EG) 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP IN (#HYPERION_OPTIMIZATION.EG_MS_CODES) AND T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE * (1-T_CAPC_EXCEPTION_EG.DRIVER_VALUE) 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_CAP' AND (T_CAPC_XACTLY_INBOUND.ORG62CODE NOT IN (#HYPERION_OPTIMIZATION.MNA_ORG62CODE) OR T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL) 
THEN 0 
WHEN DRIVER_EG_CAP_VS_EXP.DRIVER_VALUE='#HYPERION_OPTIMIZATION.CAPC_EG_EXP' 
THEN T_CAPC_XACTLY_INBOUND.COMMISSION_AMOUNT * T_CAPC_XACTLY_INBOUND.PAYMENT_EX_RATE 
ELSE 0 
END,
	T_CAPC_SUBCLOUD_TO_EG.SUBCLOUD,
	CASE
WHEN T_CAPC_XACTLY_INBOUND.EARNING_GROUP IN (#HYPERION_OPTIMIZATION.EG_MS_CODES) AND T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL
AND T_CAPC_XACTLY_INBOUND.ORG62CODE IS NULL
THEN T_CAPC_EXCEPTION_EG.DRIVER_TEXT
ELSE T_CAPC_XACTLY_INBOUND.ORG62CODE
END,
	T_CAPC_XACTLY_INBOUND.PROCESS_ID,
	T_CAPC_XACTLY_INBOUND.GL_PERIOD,
	T_CAPC_XACTLY_INBOUND.SCENARIO,
	T_CAPC_XACTLY_INBOUND.DATA_SOURCE_TYPE,
	T_CAPC_XACTLY_INBOUND.DATA_SOURCE_ID,
	T_CAPC_XACTLY_INBOUND.RUN_DATE,
	T_CAPC_XACTLY_INBOUND.ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_INBOUND"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_XACTLY_INBOUND ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_ORG62CODE_TO_EG"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_ORG62CODE_TO_EG      ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_EXCEPTION_EG      ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> DRIVER_EG_CAP_VS_EXP      ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_TITLE_TO_ROLE"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_XACTLY_TITLE_TO_ROLE ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> DRIVER_ROLE_CATCHUP      ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> DRIVER_ROLE_POOLED           ,  <?= odiRef.getObjectName(""L"", ""T_CAPC_SUBCLOUD_TO_EG"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_SUBCLOUD_TO_EG     
where	
	(1=1)
AND (T_CAPC_XACTLY_INBOUND.GL_PERIOD=T_CAPC_ORG62CODE_TO_EG.EBS_PERIOD (+)  AND UPPER(T_CAPC_XACTLY_INBOUND.ORG62CODE) = UPPER(T_CAPC_ORG62CODE_TO_EG.ORG62CODE (+) )) AND (T_CAPC_XACTLY_INBOUND.GL_PERIOD = T_CAPC_EXCEPTION_EG.GL_PERIOD (+)  
AND T_CAPC_XACTLY_INBOUND.EARNING_GROUP = T_CAPC_EXCEPTION_EG.EARNINGS_GROUP (+)  
AND T_CAPC_EXCEPTION_EG.ACCOUNT (+) ='Exception_Earninggroups') AND (CASE
    WHEN T_CAPC_XACTLY_INBOUND.EARNING_GROUP = '#HYPERION_OPTIMIZATION.CAPC_EG_MANUAL_CALCULATION'
    THEN T_CAPC_XACTLY_INBOUND.MAN_CALC_REASON_CODE
    ELSE T_CAPC_XACTLY_INBOUND.EARNING_GROUP
END /*T_CAPC_XACTLY_INBOUND.EARNING_GROUP, T_CAPC_XACTLY_INBOUND.MAN_CALC_REASON_CODE*/ = DRIVER_EG_CAP_VS_EXP.EARNINGS_GROUP (+)  
AND T_CAPC_XACTLY_INBOUND.GL_PERIOD = DRIVER_EG_CAP_VS_EXP.GL_PERIOD (+)  
AND DRIVER_EG_CAP_VS_EXP.ACCOUNT (+)  = '#HYPERION_OPTIMIZATION.CAPC_CAP_VS_EXP') AND (T_CAPC_XACTLY_INBOUND.ROLE=T_CAPC_XACTLY_TITLE_TO_ROLE.SOURCE_VALUE  (+) 
AND T_CAPC_XACTLY_INBOUND.GL_PERIOD = T_CAPC_XACTLY_TITLE_TO_ROLE.GL_PERIOD  (+)) AND (T_CAPC_XACTLY_TITLE_TO_ROLE.GL_PERIOD = DRIVER_ROLE_CATCHUP.GL_PERIOD (+) 
AND T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE = DRIVER_ROLE_CATCHUP.ROLE (+) 
AND DRIVER_ROLE_CATCHUP.ACCOUNT (+)  = '#HYPERION_OPTIMIZATION.CAPC_POOLED_CATCHUP') AND (T_CAPC_XACTLY_TITLE_TO_ROLE.GL_PERIOD = DRIVER_ROLE_POOLED.GL_PERIOD (+) 
AND T_CAPC_XACTLY_TITLE_TO_ROLE.TARGET_ROLE = DRIVER_ROLE_POOLED.ROLE (+) 
AND DRIVER_ROLE_POOLED.ACCOUNT (+)  = '#HYPERION_OPTIMIZATION.CAPC_POOLED_CLASSIFICATION') AND (T_CAPC_XACTLY_INBOUND.GL_PERIOD=T_CAPC_SUBCLOUD_TO_EG.EBS_PERIOD (+)  AND T_CAPC_XACTLY_INBOUND.SUBCLOUD=T_CAPC_SUBCLOUD_TO_EG.SUBCLOUD (+)) 
 and (T_CAPC_XACTLY_INBOUND.GL_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD' 
AND T_CAPC_XACTLY_INBOUND.DATA_SOURCE_TYPE = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' 
AND NOT ( order_code LIKE 'Period: ' || Replace('#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD','-','-20') || '%'
AND order_item_id LIKE 'Number of records generated: %'
AND ceo_number LIKE 'Sum of Payments: %' ))
   "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'Both Order start date and Incentive date Missing for Non-Pooled MS record',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'Order Startdate Missing for MS Records',
	'CK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>  T_CAPC_XACTLY_STG1
where	not 	(
		NOT (
    T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE = '#HYPERION_OPTIMIZATION.CAPC_EG_CAP'
    AND T_CAPC_XACTLY_STG1.ROLE_POOLED = '#HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED'
    AND T_CAPC_XACTLY_STG1.SUBCLOUD IN (#HYPERION_OPTIMIZATION.MNA_SUBCLOUD)
    AND T_CAPC_XACTLY_STG1.ORDER_START_DATE IS NULL
    AND T_CAPC_XACTLY_STG1.EBS_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
    AND T_CAPC_XACTLY_STG1.DATA_SOURCE_TYPE = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
)
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column PPP_CATCHUP_MONTHS cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'PPP_CATCHUP_MONTHS',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	PPP_CATCHUP_MONTHS is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column EBS_PERIOD cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'EBS_PERIOD',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	EBS_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15065: Join error (Role MISSING in Planning) between the table T_CAPC_XACTLY_STG1 and the table V_CAPCOMMZ_ROLE.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'Role MISSING in Planning',
	'FK',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> T_CAPC_XACTLY_STG1
where 	not exists	(
		select	'X' 
		from	<?= odiRef.getObjectName(""L"", ""V_CAPCOMMZ_ROLE"", ""ORA_HYPGL"", ""D"") ?> V_CAPCOMMZ_ROLE
		where	T_CAPC_XACTLY_STG1.ROLE = V_CAPCOMMZ_ROLE.CHILD
OR NVL(T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE, 'ERROR') = '#HYPERION_OPTIMIZATION.CAPC_EG_EXP'
		)
/* BEGIN - custom filter added by M. Heilos, FinTech Innovations */
and NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #HYPERION_OPTIMIZATION.CAPC_EG_EXP */
/* END - custom filter added by M. Heilos, FinTech Innovations */   "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Create flow table I$","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","create table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	CONTRACT_START_DATE	VARCHAR2(20) NULL,
	ORDER_END_DATE	VARCHAR2(20) NULL,
	ORDER_START_DATE	VARCHAR2(20) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_EX_RATE	VARCHAR2(50) NULL,
	COMMISSION_AMOUNT_INPUT	VARCHAR2(50) NULL,
	COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	COMMISSION_PERIOD	VARCHAR2(20) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(80) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP_INPUT	VARCHAR2(100) NULL,
	MAN_CALC_REASON_CODE	VARCHAR2(100) NULL,
	EARNING_GROUP	VARCHAR2(80) NULL,
	ROLE_INPUT	VARCHAR2(100) NULL,
	ROLE	VARCHAR2(80) NULL,
	COMMISSION_CURRENCY	VARCHAR2(20) NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(20) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	ROLE_CATCHUP_MONTHS	NUMBER NULL,
	PPP_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_START_PERIOD	VARCHAR2(100) NULL,
	COMMISSION_AMOUNT_ORGINAL	VARCHAR2(100) NULL,
	EXPENSE_COMMISSION	VARCHAR2(100) NULL,
	SUBCLOUD	VARCHAR2(100) NULL,
	ORG62CODE	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	EBS_PERIOD	VARCHAR2(20) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL
)  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","drop error table","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","
drop table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column SCENARIO cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'SCENARIO',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	SCENARIO is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_ID cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'DATA_SOURCE_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	DATA_SOURCE_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",37,"M","ORA Transform Xactly STG1","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG1","T_CAPC_XACTLY_STG1","","0cac3ab8-b255-4fae-96d0-91a08c02f5f2","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG1"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG1"" type=""CKM"" km=""CKM Oracle - FTI - Exclude Errors.Hyperion_Optimization"">
      <option name=""EXCLUSION_FILTER"" value=""NVL( T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE , 'unmapped') != '2' /* value has been hardcoded because CKM Option does not allow the use of variables like #CAPC_EG_EXP */"" default=""false""/>
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_INBOUND"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_TITLE_TO_ROLE"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_SUBCLOUD_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_CATCHUP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_ROLE_POOLED"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVER_EG_CAP_VS_EXP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_ORG62CODE_TO_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_EXCEPTION_EG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <target name=""T_CAPC_XACTLY_STG1"" resource=""T_CAPC_XACTLY_STG1"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle - FTI - Exclude Errors","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	<?=odiRef.getSession(""SESS_NO"") ?>, 
	rowid,
	'F', 
	'ODI-15066: The column PROCESS_ID cannot be null.',
	sysdate,
	'(25)Hyperion_Optimization.ORA Transform Xactly STG1',
	'PROCESS_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAYMENT_EX_RATE,
	COMMISSION_AMOUNT_INPUT,
	COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP_INPUT,
	MAN_CALC_REASON_CODE,
	EARNING_GROUP,
	ROLE_INPUT,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	COMMISSION_AMOUNT_ORGINAL,
	EXPENSE_COMMISSION,
	SUBCLOUD,
	ORG62CODE,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG1"", ""W"") ?>
where	PROCESS_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",38,"T","Check Transfer to STG1","","","","","","","","08cb1f18-04b6-4a21-99fc-f64ffb0730b8","","S","S","Procedure","Check Processed Records","Capture Validation Detail","J","","ORA_EBS_SFDC_CAPCOM","","BEGIN

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS, CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '3 - ORA STG1 Exp' process_step
/*SUM(Decode(eg_capital_expense, #HYPERION_OPTIMIZATION.CAPC_EG_EXP, 1, 0)) EXPENSE_RECORDS,*/
,null EXPENSE_RECORDS, null CAPITALIZED_RECORDS
FROM t_capc_xactly_stg1
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS, CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(payment_currency, -3) payment_currency, '3 - ORA STG1 Exp' process_step
/*, SUM(EXPENSE_COMMISSION) EXPENSE_RECORDS, null CAPITALIZED_RECORDS*/
,null EXPENSE_RECORDS, null CAPITALIZED_RECORDS
FROM t_capc_xactly_stg1
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3);

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '4 - ORA STG1 Error' process_step
, Count(Distinct odi_row_id) ERROR_RECORDS, null WARNING_RECORDS
FROM e$_t_capc_xactly_stg1
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, payment_currency, '4 - ORA STG1 Error' process_step
, Sum(commission_amount_orginal) ERROR_RECORDS, null WARNING_RECORDS FROM (
  SELECT DISTINCT odi_row_id, data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3) payment_currency, commission_amount_orginal 
  FROM e$_t_capc_xactly_stg1
  WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
  AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
) GROUP BY data_source_type, data_source_id, scenario, ebs_period, payment_currency;

EXCEPTION
    WHEN OTHERS THEN
        INSERT INTO t_capc_audits (gl_period, odi_process_id, data_source_type, scenario, status)
        VALUES ('#HYPERION_OPTIMIZATION.EBS_PERIOD', #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE', '#HYPERION_OPTIMIZATION.SCENARIO', '2 - ERROR: Validation Report is Invalid');

END;"
683,"CAPC_LOAD_XACTLY_DATA",38,"T","Check Transfer to STG1","","","","","","","","08cb1f18-04b6-4a21-99fc-f64ffb0730b8","","S","S","Procedure","Check Processed Records","Write Information to Audit File","B","","","","
blnCompleted = False
try:
	objAuditFile = None # need to create variable, needed below in case of failure to open
	objAuditFile = open( '#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE' , 'a' )
	objAuditFile.write(""Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>\n"")
	objAuditFile.write(""* StartTime: <?=odiRef.getPrevStepLog(""BEGIN"") ?>\n"")
	objAuditFile.write(""* EndTime: <?=odiRef.getPrevStepLog(""End"") ?>\n"")
	objAuditFile.write(""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) + ""\n"")


	objAuditFile.write(""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) + ""\n"")
	objAuditFile.write(""\n"")
	objAuditFile.write(""-   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -\n"")
	blnCompleted = True
finally:
	if not objAuditFile is None:
		objAuditFile.close()
	if not blnCompleted:
		raise Exception( ""\n\nError encountered with Audit file: #HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE\n"" )

"
683,"CAPC_LOAD_XACTLY_DATA",38,"T","Check Transfer to STG1","","","","","","","","08cb1f18-04b6-4a21-99fc-f64ffb0730b8","","S","S","Procedure","Check Processed Records","Check for Inserted Records","B","","","","if <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> > 0:
	print( ""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>)
		+ ""\n\t(expected Number of Inserts > 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",38,"T","Check Transfer to STG1","","","","","","","","08cb1f18-04b6-4a21-99fc-f64ffb0730b8","","S","S","Procedure","Check Processed Records","Check for Error Records","B","","","","if <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> == 0:
	print( ""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>)
		+ ""\n\t(expected Number of Errors == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",38,"T","Check Transfer to STG1","","","","","","","","08cb1f18-04b6-4a21-99fc-f64ffb0730b8","","S","S","Procedure","Check Processed Records","Set Stats","B","","","","odiRef.setNbInsert( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> )
odiRef.setNbErrors( <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )
odiRef.setNbRows( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> + <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )"
683,"CAPC_LOAD_XACTLY_DATA",39,"T","Enhance Xactly STG1 Data","","","","","","","","6e9860d9-1eb9-47ea-833b-ad661c81af6c","","S","S","Procedure","Enhance Xactly STG1 Data","Update CR30 - Handle Missing and Old Dates","J","","","","UPDATE t_capc_xactly_stg1
SET total_catchup_months = 2
, amort_start_period = '#HYPERION_OPTIMIZATION.CAPC_COMMISSION_PERIOD'
WHERE role_pooled = #HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED /* Non-Pooled */
AND ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
/* Order Start Date is Missing or Older than 4 years */
AND TO_DATE( NVL( order_start_date , '01-JAN-10' ) , 'dd-MON-yy' ) < ADD_MONTHS( TO_DATE( '01-#HYPERION_OPTIMIZATION.EBS_PERIOD' , 'dd-MON-yy' ) , -48 )"
683,"CAPC_LOAD_XACTLY_DATA",39,"T","Enhance Xactly STG1 Data","","","","","","","","6e9860d9-1eb9-47ea-833b-ad661c81af6c","","S","S","Procedure","Enhance Xactly STG1 Data","Derive Amort_Start_Period and Total_Catchup_Months","J","","","","UPDATE t_capc_xactly_stg1
SET amort_start_period = NVL( amort_start_period , CASE
    WHEN role_pooled = #HYPERION_OPTIMIZATION.CAPC_ROLE_POOLED /* Pooled */
    THEN TO_CHAR( Add_Months( '01-' || '#HYPERION_OPTIMIZATION.EBS_PERIOD' , 1 - ( ROLE_CATCHUP_MONTHS + PPP_CATCHUP_MONTHS ) ) , 'MON-yy' )
    WHEN role_pooled = #HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED /* Non-Pooled */
    THEN TO_CHAR( TO_DATE( ORDER_START_DATE  , 'dd-MON-yy' ) , 'MON-yy' )
  END )
, total_catchup_months = NVL( total_catchup_months , CASE
    WHEN role_pooled = #HYPERION_OPTIMIZATION.CAPC_ROLE_POOLED /* Pooled */
    THEN role_catchup_months + ppp_catchup_months
    WHEN role_pooled = #HYPERION_OPTIMIZATION.CAPC_ROLE_NON_POOLED /* Non-Pooled */
    THEN 1 + (
        Ceil(
            MONTHS_BETWEEN(
                TO_DATE( '01-#HYPERION_OPTIMIZATION.EBS_PERIOD' , 'dd-MON-yy' )
                , TO_DATE( order_start_date  , 'dd-MON-yy' ) )
        ) - CASE
            WHEN TO_CHAR( TO_DATE( order_start_date  , 'dd-MON-yy' ) , 'dd' ) * 1 > 15 
            THEN 0.5
            ELSE 0
        END )
    END )
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Capture Validation Detail","J","","ORA_EBS_SFDC_CAPCOM","","BEGIN

DELETE FROM t_capc_audits WHERE 1=0;

EXCEPTION
    WHEN OTHERS THEN
        INSERT INTO t_capc_audits (gl_period, odi_process_id, data_source_type, scenario, status)
        VALUES ('#HYPERION_OPTIMIZATION.EBS_PERIOD', #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE', '#HYPERION_OPTIMIZATION.SCENARIO', '2 - ERROR: Validation Report is Invalid');

END;"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Write Information to Audit File","B","","","","
blnCompleted = False
try:
	objAuditFile = None # need to create variable, needed below in case of failure to open
	objAuditFile = open( '#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE' , 'a' )
	objAuditFile.write(""Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>\n"")
	objAuditFile.write(""* StartTime: <?=odiRef.getPrevStepLog(""BEGIN"") ?>\n"")
	objAuditFile.write(""* EndTime: <?=odiRef.getPrevStepLog(""End"") ?>\n"")
	objAuditFile.write(""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) + ""\n"")

	objAuditFile.write(""Number of Updates: "" + str(<?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?>) + ""\n"")


	objAuditFile.write(""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) + ""\n"")
	objAuditFile.write(""\n"")
	objAuditFile.write(""-   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -\n"")
	blnCompleted = True
finally:
	if not objAuditFile is None:
		objAuditFile.close()
	if not blnCompleted:
		raise Exception( ""\n\nError encountered with Audit file: #HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE\n"" )

"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Check for Inserted Records","B","","","","if <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> == 0:
	print( ""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>)
		+ ""\n\t(expected Number of Inserts == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Check for Error Records","B","","","","if <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> == 0:
	print( ""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>)
		+ ""\n\t(expected Number of Errors == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Check for Updated Records","B","","","","if <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> > 0:
	print( ""Number of Updates: "" + str(<?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Updates: "" + str(<?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?>)
		+ ""\n\t(expected Number of Updates > 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",40,"T","Check Enhanced Data in STG1","","","","","","","","05836f71-3e9a-40e7-8aa0-62d84b640c50","","S","S","Procedure","Check Processed Records","Set Stats","B","","","","odiRef.setNbInsert( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> )
odiRef.setNbErrors( <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )
odiRef.setNbRows( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> + <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )"
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","MAP_MAIN","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","ORA_HYPGL_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_TYPE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'DATA_SOURCE_TYPE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	DATA_SOURCE_TYPE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PCC cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PCC',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PCC is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert new rows","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
insert into	<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG2"", ""ORA_HYPGL"", ""D"") ?> 
( 
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
) 
select	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER 
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column SCENARIO cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'SCENARIO',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	SCENARIO is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert check sum into check table","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>',
	'T_CAPC_XACTLY_STG2',
	'<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG2"", ""ORA_HYPGL"", ""D"") ?>',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?> E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(26)Hyperion_Optimization.ORA Transform Xactly STG2'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_ID cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'DATA_SOURCE_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	DATA_SOURCE_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_TO_BUYSELL_RATE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PAY_TO_BUYSELL_RATE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PAY_TO_BUYSELL_RATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PPP_CATCHUP_MONTHS cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PPP_CATCHUP_MONTHS',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PPP_CATCHUP_MONTHS is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COSTCENTER cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'COSTCENTER',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	COSTCENTER is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUYSELL_ENTITY cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'BUYSELL_ENTITY',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	BUYSELL_ENTITY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAYMENT_CURRENCY cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PAYMENT_CURRENCY',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PAYMENT_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert flow into I$ table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","insert into	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select 	
	T_CAPC_XACTLY_STG1.ORDER_CODE,
	T_CAPC_XACTLY_STG1.ORDER_ITEM_ID,
	T_CAPC_XACTLY_STG1.CEO_NUMBER,
	T_CAPC_XACTLY_STG1.ACCOUNT_NUMBER,
	T_CAPC_XACTLY_STG1.CUSTOMER_NAME,
	NVL( T_WORKDAY_EMPLOYEES_STG.ENTITY , V_WORKDAY_EMPLOYEES_LATEST_COA.ENTITY ),
	NVL( T_WORKDAY_EMPLOYEES_STG.PCC , V_WORKDAY_EMPLOYEES_LATEST_COA.PCC ),
	NVL( T_WORKDAY_EMPLOYEES_STG.COSTCENTER , V_WORKDAY_EMPLOYEES_LATEST_COA.COSTCENTER ),
	NVL( T_WORKDAY_EMPLOYEES_STG.BUSINESSUNIT , V_WORKDAY_EMPLOYEES_LATEST_COA.BUSINESSUNIT ),
	T_CAPC_BUYSELL_MAP.BUYSELL_ENTITY,
	T_CAPC_XACTLY_STG1.CONTRACT_NUMBER,
	T_CAPC_XACTLY_STG1.ORDER_TYPE,
	T_CAPC_XACTLY_STG1.BATCH_NAME,
	T_CAPC_XACTLY_STG1.CONTRACT_START_DATE,
	T_CAPC_XACTLY_STG1.ORDER_END_DATE,
	T_CAPC_XACTLY_STG1.ORDER_START_DATE,
	T_CAPC_XACTLY_STG1.BUSINESS_GROUP_CURRENCY,
	T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY,
	T_CAPC_XACTLY_STG1.COMMISSION_AMOUNT,
	CASE
    WHEN T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = T_CAPC_BUYSELL_MAP.BUYSELL_CURRENCY
    THEN 1
    ELSE FX_USD_HIST_AVG.FX_RATE / FX_BUYSELL_AVG_HIST.FX_RATE
END,
	T_CAPC_BUYSELL_MAP.BUYSELL_CURRENCY,
	T_CAPC_XACTLY_STG1.COMMISSION_AMOUNT *
CASE
    WHEN T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = T_CAPC_BUYSELL_MAP.BUYSELL_CURRENCY
    THEN 1
    ELSE FX_USD_HIST_AVG.FX_RATE / FX_BUYSELL_AVG_HIST.FX_RATE
END,
	CASE
    WHEN T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = 'USD'
    THEN 1
    ELSE FX_USD_CURR_EOM.FX_RATE
END,
	T_CAPC_XACTLY_STG1.COMMISSION_AMOUNT *
CASE
    WHEN T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = 'USD'
    THEN 1
    ELSE FX_USD_CURR_EOM.FX_RATE
END,
	T_CAPC_XACTLY_STG1.COMMISSION_PERIOD,
	T_CAPC_XACTLY_STG1.BUSINESS_GROUP,
	T_CAPC_XACTLY_STG1.DEPARTMENT_NUMBER,
	T_CAPC_XACTLY_STG1.PARTICIPANT_NAME,
	T_CAPC_XACTLY_STG1.SFDC_EMPLOYEE_ID,
	T_CAPC_XACTLY_STG1.POSITION_NAME,
	T_CAPC_XACTLY_STG1.EARNING_GROUP,
	T_CAPC_XACTLY_STG1.ROLE,
	T_CAPC_XACTLY_STG1.COMMISSION_CURRENCY,
	T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE,
	T_CAPC_XACTLY_STG1.ROLE_POOLED,
	T_CAPC_XACTLY_STG1.ROLE_CATCHUP_MONTHS,
	T_CAPC_XACTLY_STG1.PPP_CATCHUP_MONTHS,
	T_CAPC_XACTLY_STG1.TOTAL_CATCHUP_MONTHS,
	T_CAPC_XACTLY_STG1.AMORT_START_PERIOD,
	NVL( DRIVERS_EG_LIFE_BY_ENTITY.DRIVER_VALUE , DRIVERS_EG_LIFE_DEFAULT.DRIVER_VALUE ),
	T_CAPC_XACTLY_STG1.EXPENSE_COMMISSION,
	Null,
	T_CAPC_XACTLY_STG1.EXPENSE_COMMISSION * 
CASE 
    WHEN T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = 'USD' 
    THEN 1 
    ELSE FX_USD_CURR_EOM.FX_RATE 
END,
	T_CAPC_XACTLY_STG1.PROCESS_ID,
	T_CAPC_XACTLY_STG1.EBS_PERIOD,
	T_CAPC_XACTLY_STG1.SCENARIO,
	T_CAPC_XACTLY_STG1.DATA_SOURCE_TYPE,
	T_CAPC_XACTLY_STG1.DATA_SOURCE_ID,
	T_CAPC_XACTLY_STG1.RUN_DATE,
	T_CAPC_XACTLY_STG1.ROW_NUMBER
from	(((((((<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG1"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_XACTLY_STG1  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_WORKDAY_EMPLOYEES_STG"", ""ORA_HYPGL"", ""D"") ?> T_WORKDAY_EMPLOYEES_STG  
    ON  T_CAPC_XACTLY_STG1.SFDC_EMPLOYEE_ID = T_WORKDAY_EMPLOYEES_STG.EMPLOYEE_ID AND T_CAPC_XACTLY_STG1.AMORT_START_PERIOD=T_WORKDAY_EMPLOYEES_STG.CURRENTPERIOD
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""V_WORKDAY_EMPLOYEES_LATEST_COA"", ""ORA_HYPGL"", ""D"") ?> V_WORKDAY_EMPLOYEES_LATEST_COA  
    ON  T_CAPC_XACTLY_STG1.SFDC_EMPLOYEE_ID = V_WORKDAY_EMPLOYEES_LATEST_COA.EMPLOYEE_ID
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_BUYSELL_MAP"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_BUYSELL_MAP  
    ON  NVL( T_WORKDAY_EMPLOYEES_STG.ENTITY, V_WORKDAY_EMPLOYEES_LATEST_COA.ENTITY ) = T_CAPC_BUYSELL_MAP.BASE_ENTITY 
AND T_CAPC_XACTLY_STG1.AMORT_START_PERIOD = T_CAPC_BUYSELL_MAP.GL_PERIOD
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> DRIVERS_EG_LIFE_BY_ENTITY  
    ON  T_CAPC_XACTLY_STG1.EBS_PERIOD = DRIVERS_EG_LIFE_BY_ENTITY.GL_PERIOD
AND T_CAPC_XACTLY_STG1.EARNING_GROUP = DRIVERS_EG_LIFE_BY_ENTITY.EARNINGS_GROUP
AND DRIVERS_EG_LIFE_BY_ENTITY.ACCOUNT = '#HYPERION_OPTIMIZATION.CAPC_CUSTOMER_LIFE'
AND NVL( T_WORKDAY_EMPLOYEES_STG.ENTITY, V_WORKDAY_EMPLOYEES_LATEST_COA.ENTITY ) = DRIVERS_EG_LIFE_BY_ENTITY.ENTITY
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_DRIVERS"", ""ORA_HYPGL"", ""D"") ?> DRIVERS_EG_LIFE_DEFAULT  
    ON  T_CAPC_XACTLY_STG1.EBS_PERIOD = DRIVERS_EG_LIFE_DEFAULT.GL_PERIOD
AND T_CAPC_XACTLY_STG1.EARNING_GROUP = DRIVERS_EG_LIFE_DEFAULT.EARNINGS_GROUP
AND DRIVERS_EG_LIFE_DEFAULT.ACCOUNT = '#HYPERION_OPTIMIZATION.CAPC_CUSTOMER_LIFE'
AND DRIVERS_EG_LIFE_DEFAULT.ENTITY = 'NoEntity'
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_GL_FX_RATES"", ""ORA_HYPGL"", ""D"") ?> FX_USD_HIST_AVG  
    ON  T_CAPC_XACTLY_STG1.AMORT_START_PERIOD = FX_USD_HIST_AVG.PERIOD_NAME
AND T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = FX_USD_HIST_AVG.FROM_CURRENCY
AND FX_USD_HIST_AVG.RATE_TYPE = 'AVGRATE'
AND FX_USD_HIST_AVG.TO_CURRENCY = 'USD'
AND FX_USD_HIST_AVG.SOURCE_NAME = 'CapComm'
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_GL_FX_RATES"", ""ORA_HYPGL"", ""D"") ?> FX_BUYSELL_AVG_HIST  
    ON  FX_USD_HIST_AVG.PERIOD_NAME = FX_BUYSELL_AVG_HIST.PERIOD_NAME
AND FX_USD_HIST_AVG.RATE_TYPE = FX_BUYSELL_AVG_HIST.RATE_TYPE
AND FX_USD_HIST_AVG.TO_CURRENCY = FX_BUYSELL_AVG_HIST.TO_CURRENCY
AND FX_USD_HIST_AVG.SOURCE_NAME=FX_BUYSELL_AVG_HIST.SOURCE_NAME
AND FX_BUYSELL_AVG_HIST.FROM_CURRENCY = T_CAPC_BUYSELL_MAP.BUYSELL_CURRENCY
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName(""L"", ""T_CAPC_GL_FX_RATES"", ""ORA_HYPGL"", ""D"") ?> FX_USD_CURR_EOM  
    ON  T_CAPC_XACTLY_STG1.PAYMENT_CURRENCY = FX_USD_CURR_EOM.FROM_CURRENCY
AND T_CAPC_XACTLY_STG1.EBS_PERIOD = FX_USD_CURR_EOM.PERIOD_NAME
AND FX_USD_CURR_EOM.TO_CURRENCY = 'USD'
AND FX_USD_CURR_EOM.RATE_TYPE = 'EOMRATE'
AND FX_USD_CURR_EOM.SOURCE_NAME = 'CapComm'
where	
	(1=1)
 and (/* T_CAPC_XACTLY_STG1.EG_CAPITAL_EXPENSE = #HYPERION_OPTIMIZATION.CAPC_EG_CAP  Capitalize  
AND */ T_CAPC_XACTLY_STG1.EBS_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD' 
AND T_CAPC_XACTLY_STG1.DATA_SOURCE_TYPE = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE')
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create index on error table","CKM Oracle","","J","","ORA_HYPGL",""," 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
create index 	<?=odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2_IDX"", ""W"") ?> 
on	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?> (ODI_ROW_ID)
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete errors from controlled table","CKM Oracle","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>  T
where	exists 	(
		select	1
		from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?> E
		where ODI_SESS_NO = '<?=odiRef.getSession(""SESS_GUID"") ?>'
		and T.rowid = E.ODI_ROW_ID
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_EXPENSE_AMOUNT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PAY_EXPENSE_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PAY_EXPENSE_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EG_CUSTOMER_LIFE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'EG_CUSTOMER_LIFE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	EG_CUSTOMER_LIFE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_TO_USD_RATE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PAY_TO_USD_RATE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PAY_TO_USD_RATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column ENTITY cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'ENTITY',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	ENTITY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column SFDC_EMPLOYEE_ID cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'SFDC_EMPLOYEE_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	SFDC_EMPLOYEE_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EBS_PERIOD cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'EBS_PERIOD',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	EBS_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","drop error table","CKM Oracle","","J","","ORA_HYPGL","","
drop table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_PERIOD cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'COMMISSION_PERIOD',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	COMMISSION_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUYSELL_COMMISSION_AMOUNT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'BUYSELL_COMMISSION_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	BUYSELL_COMMISSION_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column USD_EXPENSE_AMOUNT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'USD_EXPENSE_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	USD_EXPENSE_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUYSELL_CURRENCY cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'BUYSELL_CURRENCY',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	BUYSELL_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Delete target table - SELECTIVELY","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","delete from <?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG2"", ""ORA_HYPGL"", ""D"") ?>
/* added to original IKM: */
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'   "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column ROLE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'ROLE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	ROLE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EG_CAPITAL_EXPENSE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'EG_CAPITAL_EXPENSE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	EG_CAPITAL_EXPENSE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_COMMISSION_AMOUNT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PAY_COMMISSION_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PAY_COMMISSION_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column ROLE_POOLED cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'ROLE_POOLED',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	ROLE_POOLED is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create error table","CKM Oracle","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_ROW_ID 		UROWID,
	ODI_ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL, 
	ODI_ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL, 
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	ENTITY	VARCHAR2(80) NULL,
	PCC	VARCHAR2(80) NULL,
	COSTCENTER	VARCHAR2(80) NULL,
	BUSINESS_UNIT	VARCHAR2(80) NULL,
	BUYSELL_ENTITY	VARCHAR2(20) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	CONTRACT_START_DATE	VARCHAR2(20) NULL,
	ORDER_END_DATE	VARCHAR2(20) NULL,
	ORDER_START_DATE	VARCHAR2(20) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_CURRENCY	VARCHAR2(20) NULL,
	PAY_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	PAY_TO_BUYSELL_RATE	VARCHAR2(50) NULL,
	BUYSELL_CURRENCY	VARCHAR2(20) NULL,
	BUYSELL_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	PAY_TO_USD_RATE	VARCHAR2(50) NULL,
	USD_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	COMMISSION_PERIOD	VARCHAR2(20) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(80) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP	VARCHAR2(80) NULL,
	ROLE	VARCHAR2(80) NULL,
	COMMISSION_CURRENCY	VARCHAR2(20) NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(20) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	ROLE_CATCHUP_MONTHS	NUMBER NULL,
	PPP_CATCHUP_MONTHS	NUMBER NULL,
	TOTAL_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_START_PERIOD	VARCHAR2(20) NULL,
	EG_CUSTOMER_LIFE	NUMBER NULL,
	PAY_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	BUYSELL_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	USD_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	ATTRIBUTE4	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	EBS_PERIOD	VARCHAR2(20) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL,
	ODI_ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	ODI_CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ODI_PK			<?=odiRef.getDataType(""DEST_VARCHAR"", ""32"") ?> PRIMARY KEY,
	ODI_SESS_NO		<?=odiRef.getDataType(""DEST_VARCHAR"", ""36"") ?>
)
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Commit transaction","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","/* commit */ "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column RUN_DATE cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'RUN_DATE',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	RUN_DATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EARNING_GROUP cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'EARNING_GROUP',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	EARNING_GROUP is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Create flow table I$","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","create table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ORDER_CODE	VARCHAR2(255) NULL,
	ORDER_ITEM_ID	VARCHAR2(100) NULL,
	CEO_NUMBER	VARCHAR2(255) NULL,
	ACCOUNT_NUMBER	VARCHAR2(255) NULL,
	CUSTOMER_NAME	VARCHAR2(255) NULL,
	ENTITY	VARCHAR2(80) NULL,
	PCC	VARCHAR2(80) NULL,
	COSTCENTER	VARCHAR2(80) NULL,
	BUSINESS_UNIT	VARCHAR2(80) NULL,
	BUYSELL_ENTITY	VARCHAR2(20) NULL,
	CONTRACT_NUMBER	VARCHAR2(100) NULL,
	ORDER_TYPE	VARCHAR2(100) NULL,
	BATCH_NAME	VARCHAR2(255) NULL,
	CONTRACT_START_DATE	VARCHAR2(20) NULL,
	ORDER_END_DATE	VARCHAR2(20) NULL,
	ORDER_START_DATE	VARCHAR2(20) NULL,
	BUSINESS_GROUP_CURRENCY	VARCHAR2(20) NULL,
	PAYMENT_CURRENCY	VARCHAR2(20) NULL,
	PAY_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	PAY_TO_BUYSELL_RATE	VARCHAR2(50) NULL,
	BUYSELL_CURRENCY	VARCHAR2(20) NULL,
	BUYSELL_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	PAY_TO_USD_RATE	VARCHAR2(50) NULL,
	USD_COMMISSION_AMOUNT	VARCHAR2(50) NULL,
	COMMISSION_PERIOD	VARCHAR2(20) NULL,
	BUSINESS_GROUP	VARCHAR2(100) NULL,
	DEPARTMENT_NUMBER	VARCHAR2(100) NULL,
	PARTICIPANT_NAME	VARCHAR2(255) NULL,
	SFDC_EMPLOYEE_ID	VARCHAR2(80) NULL,
	POSITION_NAME	VARCHAR2(255) NULL,
	EARNING_GROUP	VARCHAR2(80) NULL,
	ROLE	VARCHAR2(80) NULL,
	COMMISSION_CURRENCY	VARCHAR2(20) NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(20) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	ROLE_CATCHUP_MONTHS	NUMBER NULL,
	PPP_CATCHUP_MONTHS	NUMBER NULL,
	TOTAL_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_START_PERIOD	VARCHAR2(20) NULL,
	EG_CUSTOMER_LIFE	NUMBER NULL,
	PAY_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	BUYSELL_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	USD_EXPENSE_AMOUNT	VARCHAR2(100) NULL,
	PROCESS_ID	NUMBER NULL,
	EBS_PERIOD	VARCHAR2(20) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	ROW_NUMBER	NUMBER NULL
)  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create check table","CKM Oracle","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	CATALOG_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	SCHEMA_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	RESOURCE_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	FULL_RES_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL,
	ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL ,
	CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL,
	ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ERR_COUNT		<?=odiRef.getDataType(""DEST_NUMERIC"", ""10"") ?> NULL
)
	  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUSINESS_UNIT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'BUSINESS_UNIT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	BUSINESS_UNIT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous errors","CKM Oracle","","J","","ORA_HYPGL","","delete from 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(26)Hyperion_Optimization.ORA Transform Xactly STG2')
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PROCESS_ID cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'PROCESS_ID',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	PROCESS_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",41,"M","ORA Transform Xactly STG2","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_XACTLY_STG2","T_CAPC_XACTLY_STG2","","1f34398b-7333-4de3-82dd-b5bad1ca861c","<map-generation-info>
   <node name=""T_CAPC_XACTLY_STG2"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""ebs_period = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""false""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_XACTLY_STG2"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""JOIN3"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN4"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN2"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN6"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN5"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN1"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN7"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""JOIN"" type=""XKM"" km=""XKM SQL Join.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG1"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_DEFAULT"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""DRIVERS_EG_LIFE_BY_ENTITY"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""V_WORKDAY_EMPLOYEES_LATEST_COA"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_CAPC_BUYSELL_MAP"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_CURR_EOM"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_BUYSELL_AVG_HIST"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""FX_USD_HIST_AVG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <node name=""T_WORKDAY_EMPLOYEES_STG"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_XACTLY_STG2"" resource=""T_CAPC_XACTLY_STG2"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column USD_COMMISSION_AMOUNT cannot be null.',
	sysdate,
	'(26)Hyperion_Optimization.ORA Transform Xactly STG2',
	'USD_COMMISSION_AMOUNT',
	'NN',	
	ORDER_CODE,
	ORDER_ITEM_ID,
	CEO_NUMBER,
	ACCOUNT_NUMBER,
	CUSTOMER_NAME,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	BUYSELL_ENTITY,
	CONTRACT_NUMBER,
	ORDER_TYPE,
	BATCH_NAME,
	CONTRACT_START_DATE,
	ORDER_END_DATE,
	ORDER_START_DATE,
	BUSINESS_GROUP_CURRENCY,
	PAYMENT_CURRENCY,
	PAY_COMMISSION_AMOUNT,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	BUYSELL_COMMISSION_AMOUNT,
	PAY_TO_USD_RATE,
	USD_COMMISSION_AMOUNT,
	COMMISSION_PERIOD,
	BUSINESS_GROUP,
	DEPARTMENT_NUMBER,
	PARTICIPANT_NAME,
	SFDC_EMPLOYEE_ID,
	POSITION_NAME,
	EARNING_GROUP,
	ROLE,
	COMMISSION_CURRENCY,
	EG_CAPITAL_EXPENSE,
	ROLE_POOLED,
	ROLE_CATCHUP_MONTHS,
	PPP_CATCHUP_MONTHS,
	TOTAL_CATCHUP_MONTHS,
	AMORT_START_PERIOD,
	EG_CUSTOMER_LIFE,
	PAY_EXPENSE_AMOUNT,
	BUYSELL_EXPENSE_AMOUNT,
	USD_EXPENSE_AMOUNT,
	PROCESS_ID,
	EBS_PERIOD,
	SCENARIO,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	ROW_NUMBER
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_XACTLY_STG2"", ""W"") ?>
where	USD_COMMISSION_AMOUNT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",42,"T","Check Transfer to STG2","","","","","","","","02110440-d48d-4968-8785-579f4c7b4500","","S","S","Procedure","Check Processed Records","Capture Validation Detail","J","","ORA_EBS_SFDC_CAPCOM","","BEGIN

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS, CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '5 - ORA STG2 Cap' process_step
/*, null EXPENSE_RECORDS, Sum(Decode(eg_capital_expense, 1 #HYPERION_OPTIMIZATION.CAPC_EG_CAP, 1, 0)) CAPITALIZED_RECORDS*/
, Sum(Decode(eg_capital_expense, #HYPERION_OPTIMIZATION.CAPC_EG_EXP, 1, 0)) EXPENSE_RECORDS, Sum(Decode(eg_capital_expense,#HYPERION_OPTIMIZATION.CAPC_EG_CAP, 1, 0)) CAPITALIZED_RECORDS
FROM t_capc_xactly_stg2
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period;

/*
INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS, RENEWAL_ADVANCE, CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(payment_currency, -3) payment_currency, '5 - ORA STG2 Cap' process_step
/*, null EXPENSE_RECORDS, SUM(Decode(eg_capital_expense, #HYPERION_OPTIMIZATION.CAPC_EG_CAP, pay_commission_amount, 0)) CAPITALIZED_RECORDS
, (SUM(NVL(PAY_EXPENSE_AMOUNT,0))-(Select NVL(SUM(NVL(PAY_EXPENSE_AMOUNT,0)),0) from T_CAPC_XACTLY_STG2 
where upper(EARNING_GROUP) like '%EG_RENEWALS_ADVANCE%'
and Process_ID = #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID)) EXPENSE_RECORDS, 
(Select NVL(SUM(NVL(PAY_EXPENSE_AMOUNT,0)),0) from T_CAPC_XACTLY_STG2 
where upper(EARNING_GROUP) like '%EG_RENEWALS_ADVANCE%'
and Process_ID = #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID) RENEWAL_ADVANCE,  
SUM(Decode(eg_capital_expense, #HYPERION_OPTIMIZATION.CAPC_EG_CAP, pay_commission_amount, 0)) CAPITALIZED_RECORDS
FROM t_capc_xactly_stg2
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3);
*/

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS,RENEWAL_ADVANCE, CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(payment_currency, -3) payment_currency, '5 - ORA STG2 Cap' process_step
, SUM(NVL(PAY_EXPENSE_AMOUNT,0)) EXPENSE_RECORDS,0 RENEWAL_ADVANCE, SUM(Decode(eg_capital_expense, 1 /* #HYPERION_OPTIMIZATION.CAPC_EG_CAP */, pay_commission_amount, 0)) CAPITALIZED_RECORDS
FROM t_capc_xactly_stg2
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND upper(EARNING_GROUP) Not like '%EG_RENEWALS_ADVANCE%'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3);

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, EXPENSE_RECORDS, RENEWAL_ADVANCE,CAPITALIZED_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(payment_currency, -3) payment_currency, '5 - ORA STG2 Cap' process_step
, 0 EXPENSE_RECORDS, SUM(NVL(PAY_EXPENSE_AMOUNT,0)) RENEWAL_ADVANCE,0 CAPITALIZED_RECORDS
FROM t_capc_xactly_stg2
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND upper(EARNING_GROUP) like '%EG_RENEWALS_ADVANCE%'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3);


INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '6 - ORA STG2 Error' process_step
, Count(Distinct odi_row_id) ERROR_RECORDS, null WARNING_RECORDS
FROM e$_t_capc_xactly_stg2
WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
GROUP BY data_source_type, data_source_id, scenario, ebs_period;

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, ERROR_RECORDS, WARNING_RECORDS)
SELECT data_source_type, data_source_id, scenario, ebs_period gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, payment_currency, '6 - ORA STG2 Error' process_step
, Sum(pay_commission_amount+pay_expense_amount) ERROR_RECORDS, null WARNING_RECORDS FROM (
  SELECT DISTINCT odi_row_id, data_source_type, data_source_id, scenario, ebs_period, SubStr(payment_currency, -3) payment_currency, pay_commission_amount, pay_expense_amount
  FROM e$_t_capc_xactly_stg2
  WHERE ebs_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
  AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'
) GROUP BY data_source_type, data_source_id, scenario, ebs_period, payment_currency;

EXCEPTION
    WHEN OTHERS THEN
        INSERT INTO t_capc_audits (gl_period, odi_process_id, data_source_type, scenario, status)
        VALUES ('#HYPERION_OPTIMIZATION.EBS_PERIOD', #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE', '#HYPERION_OPTIMIZATION.SCENARIO', '2 - ERROR: Validation Report is Invalid');

END;"
683,"CAPC_LOAD_XACTLY_DATA",42,"T","Check Transfer to STG2","","","","","","","","02110440-d48d-4968-8785-579f4c7b4500","","S","S","Procedure","Check Processed Records","Write Information to Audit File","B","","","","
blnCompleted = False
try:
	objAuditFile = None # need to create variable, needed below in case of failure to open
	objAuditFile = open( '#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE' , 'a' )
	objAuditFile.write(""Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>\n"")
	objAuditFile.write(""* StartTime: <?=odiRef.getPrevStepLog(""BEGIN"") ?>\n"")
	objAuditFile.write(""* EndTime: <?=odiRef.getPrevStepLog(""End"") ?>\n"")
	objAuditFile.write(""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) + ""\n"")


	objAuditFile.write(""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) + ""\n"")
	objAuditFile.write(""\n"")
	objAuditFile.write(""-   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -\n"")
	blnCompleted = True
finally:
	if not objAuditFile is None:
		objAuditFile.close()
	if not blnCompleted:
		raise Exception( ""\n\nError encountered with Audit file: #HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE\n"" )

"
683,"CAPC_LOAD_XACTLY_DATA",42,"T","Check Transfer to STG2","","","","","","","","02110440-d48d-4968-8785-579f4c7b4500","","S","S","Procedure","Check Processed Records","Check for Inserted Records","B","","","","if <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> > 0:
	print( ""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>)
		+ ""\n\t(expected Number of Inserts > 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",42,"T","Check Transfer to STG2","","","","","","","","02110440-d48d-4968-8785-579f4c7b4500","","S","S","Procedure","Check Processed Records","Check for Error Records","B","","","","if <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> == 0:
	print( ""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>)
		+ ""\n\t(expected Number of Errors == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",42,"T","Check Transfer to STG2","","","","","","","","02110440-d48d-4968-8785-579f4c7b4500","","S","S","Procedure","Check Processed Records","Set Stats","B","","","","odiRef.setNbInsert( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> )
odiRef.setNbErrors( <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )
odiRef.setNbRows( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> + <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )"
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column SCENARIO cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'SCENARIO',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	SCENARIO is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","drop error table","CKM Oracle","","J","","ORA_HYPGL","","
drop table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Delete target table - SELECTIVELY","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","delete from <?= odiRef.getObjectName(""L"", ""T_CAPC_DATALOAD"", ""ORA_HYPGL"", ""D"") ?>
/* added to original IKM: */
WHERE GL_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND data_source_type = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE'   "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_AMOUNT_PAY_CURRENCY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'COMMISSION_AMOUNT_PAY_CURRENCY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	COMMISSION_AMOUNT_PAY_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15065: Join error (INVALID CostCenter) between the table T_CAPC_DATALOAD and the table V_CAPCOMMZ_COSTCENTER.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'INVALID CostCenter',
	'FK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?> T_CAPC_DATALOAD 
where 	(
		T_CAPC_DATALOAD.COSTCENTER 
	) not in 	(
		select 	CHILD
		from 	<?= odiRef.getObjectName(""L"", ""V_CAPCOMM_COSTCENTER"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_DATALOAD.COSTCENTER is not null 
	)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAYMENT_CURRENCY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'PAYMENT_CURRENCY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	PAYMENT_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert new rows","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
insert into	<?= odiRef.getObjectName(""L"", ""T_CAPC_DATALOAD"", ""ORA_HYPGL"", ""D"") ?> 
( 
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD 
	,ORDER_LINE_ID 
) 
select	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD 
	,'OLID_' || Trim( TO_CHAR( 
/* Analytical Function - START */
DENSE_RANK() OVER (
	PARTITION BY FISCAL_YEAR, FISCAL_PERIOD, SCENARIO, VERSION, ENTITY, PCC, COSTCENTER, BUSINESS_UNIT, EMPLOYEE_ID, EARNINGS_GROUP, ROLE, HYP_LOAD_BATCH, BUYSELL_ENTITY, PAYMENT_CURRENCY, BUYSELL_CURRENCY
	ORDER BY PAY_TO_BUYSELL_RATE, PAY_TO_USD_RATE, EG_CAPITAL_EXPENSE, EG_CUSTOMER_LIFE, TOTAL_CATCHUP_MONTHS, AMORT_LIFE, AMORT_START_PERIOD, ROLE_POOLED
)
/* Analytical Function - END */
, '00000' ) ) 
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?> 
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_TYPE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'DATA_SOURCE_TYPE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	DATA_SOURCE_TYPE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Insert flow into I$ table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","insert into	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select 	
	('#HYPERION_OPTIMIZATION.HYP_YEAR'),
	('#HYPERION_OPTIMIZATION.HYP_PERIOD'),
	T_CAPC_XACTLY_STG2.SCENARIO,
	('#HYPERION_OPTIMIZATION.VERSION'),
	T_CAPC_XACTLY_STG2.ENTITY,
	T_CAPC_XACTLY_STG2.PCC,
	T_CAPC_XACTLY_STG2.COSTCENTER,
	T_CAPC_XACTLY_STG2.BUSINESS_UNIT,
	(SubStr( NVL( CASE
    WHEN /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )*/
Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , Replace(CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8' ) */ IS NULL THEN NULL
    ELSE 'CA_' || /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )*/
Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , Replace(CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8' ) */
END , 'NoCustomer' ) , 1 , 80 )),
	(SubStr( /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.CUSTOMER_NAME , '' )*/
Decode( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , Replace(CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.CUSTOMER_NAME , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII', 'UTF8' ) */ , 1 , 80 )),
	(CASE
    WHEN T_CAPC_XACTLY_STG2.SFDC_EMPLOYEE_ID IS NULL THEN NULL
    ELSE 'H_' || T_CAPC_XACTLY_STG2.SFDC_EMPLOYEE_ID
END),
	T_CAPC_XACTLY_STG2.EARNING_GROUP,
	T_CAPC_XACTLY_STG2.ROLE,
	('BATCH_#HYPERION_OPTIMIZATION.HYP_YEAR' || '_#HYPERION_OPTIMIZATION.HYP_PERIOD'),
	(Replace( T_CAPC_XACTLY_STG2.BUYSELL_ENTITY , 'E_' , '' )),
	(CASE
    WHEN T_CAPC_XACTLY_STG2.PAYMENT_CURRENCY IS NULL THEN NULL
    ELSE 'P_' || T_CAPC_XACTLY_STG2.PAYMENT_CURRENCY
END),
	(Sum( T_CAPC_XACTLY_STG2.PAY_COMMISSION_AMOUNT )),
	T_CAPC_XACTLY_STG2.PAY_TO_BUYSELL_RATE,
	(CASE
    WHEN T_CAPC_XACTLY_STG2.BUYSELL_CURRENCY IS NULL THEN NULL
    ELSE 'B_' || T_CAPC_XACTLY_STG2.BUYSELL_CURRENCY
END),
	(Sum( T_CAPC_XACTLY_STG2.BUYSELL_COMMISSION_AMOUNT )),
	T_CAPC_XACTLY_STG2.PAY_TO_USD_RATE,
	(Sum( T_CAPC_XACTLY_STG2.USD_COMMISSION_AMOUNT )),
	T_CAPC_XACTLY_STG2.EG_CAPITAL_EXPENSE,
	(/*T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE
Date: 10/19/2021
Purpose: No Need to calculate EG_CUSTOMER_LIFE for Expense Records
*/
CASE
WHEN T_CAPC_XACTLY_STG2.EG_CAPITAL_EXPENSE ='#HYPERION_OPTIMIZATION.CAPC_EG_CAP'
THEN T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE
ELSE 0
END),
	(/*T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS
Date: 10/19/2021
Purpose: No Need to calculate Total_Catchup_Months for Expense Records
*/
CASE
WHEN T_CAPC_XACTLY_STG2.EG_CAPITAL_EXPENSE ='#HYPERION_OPTIMIZATION.CAPC_EG_CAP'
THEN T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS
ELSE 0
END),
	(/* Was---T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE - T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS
Date: 10/19/2021
Purpose: No Need to calculate AMORT_life for Expense Records
*/
CASE
WHEN T_CAPC_XACTLY_STG2.EG_CAPITAL_EXPENSE ='#HYPERION_OPTIMIZATION.CAPC_EG_CAP'
THEN T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE - T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS
ELSE 0
END),
	(CASE
	WHEN RegExp_Like( Trim( T_CAPC_XACTLY_STG2.ORDER_CODE ), '^[[:digit:]]+$$') 
	THEN T_CAPC_XACTLY_STG2.ORDER_CODE 
	ELSE null
END),
	(CASE
	WHEN RegExp_Like( Trim( T_CAPC_XACTLY_STG2.CONTRACT_NUMBER ), '^[[:digit:]]+$$') 
	THEN T_CAPC_XACTLY_STG2.CONTRACT_NUMBER 
	ELSE null
END),
	T_CAPC_XACTLY_STG2.ORDER_START_DATE,
	T_CAPC_XACTLY_STG2.ORDER_END_DATE,
	T_CAPC_XACTLY_STG2.AMORT_START_PERIOD,
	T_CAPC_XACTLY_STG2.ROLE_POOLED,
	T_CAPC_XACTLY_STG2.PROCESS_ID,
	T_CAPC_XACTLY_STG2.EBS_PERIOD,
	T_CAPC_XACTLY_STG2.DATA_SOURCE_TYPE,
	T_CAPC_XACTLY_STG2.DATA_SOURCE_ID,
	T_CAPC_XACTLY_STG2.RUN_DATE,
	(Sum(T_CAPC_XACTLY_STG2.PAY_EXPENSE_AMOUNT)),
	Null,
	(Sum(T_CAPC_XACTLY_STG2.USD_EXPENSE_AMOUNT))
from	<?= odiRef.getObjectName(""L"", ""T_CAPC_XACTLY_STG2"", ""ORA_HYPGL"", ""D"") ?> T_CAPC_XACTLY_STG2
where	
	(1=1)
 and (T_CAPC_XACTLY_STG2.EBS_PERIOD = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
AND T_CAPC_XACTLY_STG2.DATA_SOURCE_TYPE = '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE')
group by '#HYPERION_OPTIMIZATION.HYP_YEAR', '#HYPERION_OPTIMIZATION.HYP_PERIOD', T_CAPC_XACTLY_STG2.SCENARIO, '#HYPERION_OPTIMIZATION.VERSION', T_CAPC_XACTLY_STG2.ENTITY, T_CAPC_XACTLY_STG2.PCC, T_CAPC_XACTLY_STG2.COSTCENTER, T_CAPC_XACTLY_STG2.BUSINESS_UNIT, SubStr( NVL( CASE
    WHEN /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )*/
Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , Replace(CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8' ) */ IS NULL THEN NULL
    ELSE 'CA_' || /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )*/
Decode( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , Replace(CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.ACCOUNT_NUMBER , 'US7ASCII', 'UTF8' ) */
END, 'NoCustomer' ), 1, 80 ), SubStr( /* to clear string if it contains non-ASCII chars: */
/*Decode( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII' , 'UTF8' ) , T_CAPC_XACTLY_STG2.CUSTOMER_NAME , '' )*/
Decode( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , Replace(CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII' , 'UTF8' ) ,'""',''), T_CAPC_XACTLY_STG2.CUSTOMER_NAME , '' )
/* to replace non-ASCII chars with '?': 
CONVERT( T_CAPC_XACTLY_STG2.CUSTOMER_NAME , 'US7ASCII', 'UTF8' ) */, 1, 80 ), CASE
    WHEN T_CAPC_XACTLY_STG2.SFDC_EMPLOYEE_ID IS NULL THEN NULL
    ELSE 'H_' || T_CAPC_XACTLY_STG2.SFDC_EMPLOYEE_ID
END, T_CAPC_XACTLY_STG2.EARNING_GROUP, T_CAPC_XACTLY_STG2.ROLE, 'BATCH_#HYPERION_OPTIMIZATION.HYP_YEAR' || '_#HYPERION_OPTIMIZATION.HYP_PERIOD', Replace( T_CAPC_XACTLY_STG2.BUYSELL_ENTITY, 'E_', '' ), CASE
    WHEN T_CAPC_XACTLY_STG2.PAYMENT_CURRENCY IS NULL THEN NULL
    ELSE 'P_' || T_CAPC_XACTLY_STG2.PAYMENT_CURRENCY
END, T_CAPC_XACTLY_STG2.PAY_TO_BUYSELL_RATE, CASE
    WHEN T_CAPC_XACTLY_STG2.BUYSELL_CURRENCY IS NULL THEN NULL
    ELSE 'B_' || T_CAPC_XACTLY_STG2.BUYSELL_CURRENCY
END, T_CAPC_XACTLY_STG2.PAY_TO_USD_RATE, T_CAPC_XACTLY_STG2.EG_CAPITAL_EXPENSE, T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE, T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS, T_CAPC_XACTLY_STG2.EG_CUSTOMER_LIFE - T_CAPC_XACTLY_STG2.TOTAL_CATCHUP_MONTHS, CASE
	WHEN RegExp_Like( Trim( T_CAPC_XACTLY_STG2.ORDER_CODE ), '^[[:digit:]]+$$') 
	THEN T_CAPC_XACTLY_STG2.ORDER_CODE 
	ELSE null
END
, CASE
	WHEN RegExp_Like( Trim( T_CAPC_XACTLY_STG2.CONTRACT_NUMBER ), '^[[:digit:]]+$$') 
	THEN T_CAPC_XACTLY_STG2.CONTRACT_NUMBER 
	ELSE null
END
, T_CAPC_XACTLY_STG2.ORDER_START_DATE, T_CAPC_XACTLY_STG2.ORDER_END_DATE, T_CAPC_XACTLY_STG2.AMORT_START_PERIOD, T_CAPC_XACTLY_STG2.ROLE_POOLED, T_CAPC_XACTLY_STG2.PROCESS_ID, T_CAPC_XACTLY_STG2.EBS_PERIOD, T_CAPC_XACTLY_STG2.DATA_SOURCE_TYPE, T_CAPC_XACTLY_STG2.DATA_SOURCE_ID, T_CAPC_XACTLY_STG2.RUN_DATE
having Sum( T_CAPC_XACTLY_STG2.PAY_COMMISSION_AMOUNT ) != 0 
OR Sum( T_CAPC_XACTLY_STG2.BUYSELL_COMMISSION_AMOUNT ) != 0 
OR Sum( T_CAPC_XACTLY_STG2.USD_COMMISSION_AMOUNT ) != 0 
OR Sum( T_CAPC_XACTLY_STG2.PAY_EXPENSE_AMOUNT ) != 0 
OR Sum( T_CAPC_XACTLY_STG2.BUYSELL_EXPENSE_AMOUNT ) != 0 
OR Sum( T_CAPC_XACTLY_STG2.USD_EXPENSE_AMOUNT ) != 0
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15065: Join error (INVALID Entity) between the table T_CAPC_DATALOAD and the table V_CAPCOMMZ_ENTITY.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'INVALID Entity',
	'FK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?> T_CAPC_DATALOAD 
where 	(
		T_CAPC_DATALOAD.ENTITY 
	) not in 	(
		select 	CHILD
		from 	<?= odiRef.getObjectName(""L"", ""V_CAPCOMMZ_ENTITY"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_DATALOAD.ENTITY is not null 
	)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUYSELL_CURRENCY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'BUYSELL_CURRENCY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	BUYSELL_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'Either the BuySell Entity or its Currency are invalid',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'BUYSELL_CROSS_CHECK',
	'CK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>  T_CAPC_DATALOAD
where	not 	(
		T_CAPC_DATALOAD.BUYSELL_CURRENCY = (
	SELECT 'B_' || buysell_currency
	FROM t_capc_buysell_map
	WHERE base_entity = T_CAPC_DATALOAD.ENTITY
	AND gl_period =  T_CAPC_DATALOAD.AMORT_START_PERIOD
)
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PCC cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'PCC',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	PCC is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EG_CUSTOMER_LIFE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'EG_CUSTOMER_LIFE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	EG_CUSTOMER_LIFE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'BuySell Currency as provided in MANUAL file does not match BuySell Entity''s Currency',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'BuySell Currency DOES NOT MATCH',
	'CK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>  T_CAPC_DATALOAD
where	not 	(
		T_CAPC_DATALOAD.BUYSELL_CURRENCY = (
    SELECT DISTINCT 'B_' || m.buysell_currency
    FROM t_capc_buysell_map m
    WHERE m.buysell_entity = T_CAPC_DATALOAD.BUYSELL_ENTITY
    AND m.gl_period = T_CAPC_DATALOAD.GL_PERIOD
)
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_AMOUNT_BUYSELL_CURR cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'COMMISSION_AMOUNT_BUYSELL_CURR',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	COMMISSION_AMOUNT_BUYSELL_CURR is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_TO_BUYSELL_RATE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'PAY_TO_BUYSELL_RATE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	PAY_TO_BUYSELL_RATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15065: Join error (INVALID PCC) between the table T_CAPC_DATALOAD and the table V_CAPCOMMZ_PCC.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'INVALID PCC',
	'FK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?> T_CAPC_DATALOAD 
where 	(
		T_CAPC_DATALOAD.PCC 
	) not in 	(
		select 	CHILD
		from 	<?= odiRef.getObjectName(""L"", ""V_CAPCOMM_PCC"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_DATALOAD.PCC is not null 
	)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column ROLE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'ROLE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	ROLE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column HYP_LOAD_BATCH cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'HYP_LOAD_BATCH',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	HYP_LOAD_BATCH is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COSTCENTER cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'COSTCENTER',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	COSTCENTER is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PAY_TO_USD_RATE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'PAY_TO_USD_RATE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	PAY_TO_USD_RATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column ENTITY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'ENTITY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	ENTITY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Create flow table I$","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","create table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	FISCAL_YEAR	VARCHAR2(80) NULL,
	FISCAL_PERIOD	VARCHAR2(80) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	VERSION	VARCHAR2(80) NULL,
	ENTITY	VARCHAR2(80) NULL,
	PCC	VARCHAR2(80) NULL,
	COSTCENTER	VARCHAR2(80) NULL,
	BUSINESS_UNIT	VARCHAR2(80) NULL,
	CUSTOMER_NUMBER	VARCHAR2(80) NULL,
	CUSTOMER_NAME	VARCHAR2(80) NULL,
	EMPLOYEE_ID	VARCHAR2(80) NULL,
	EARNINGS_GROUP	VARCHAR2(80) NULL,
	ROLE	VARCHAR2(80) NULL,
	ORDER_LINE_ID	VARCHAR2(80) NULL,
	HYP_LOAD_BATCH	VARCHAR2(80) NULL,
	BUYSELL_ENTITY	VARCHAR2(80) NULL,
	PAYMENT_CURRENCY	VARCHAR2(80) NULL,
	COMMISSION_AMOUNT_PAY_CURRENCY	NUMBER NULL,
	PAY_TO_BUYSELL_RATE	NUMBER NULL,
	BUYSELL_CURRENCY	VARCHAR2(80) NULL,
	COMMISSION_AMOUNT_BUYSELL_CURR	NUMBER NULL,
	PAY_TO_USD_RATE	NUMBER NULL,
	COMMISSION_AMOUNT_USD	NUMBER NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(15) NULL,
	EG_CUSTOMER_LIFE	VARCHAR2(15) NULL,
	TOTAL_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_LIFE	NUMBER NULL,
	ORDER_CODE	VARCHAR2(50) NULL,
	CONTRACT_NUMBER	VARCHAR2(50) NULL,
	ORDER_START_DATE	VARCHAR2(15) NULL,
	ORDER_END_DATE	VARCHAR2(15) NULL,
	AMORT_START_PERIOD	VARCHAR2(15) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	PROCESS_ID	NUMBER NULL,
	GL_PERIOD	VARCHAR2(100) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	EXPENSE_AMOUNT_PAY_CURRENCY	NUMBER NULL,
	EXPENSE_AMOUNT_BUYSELL_CURR	NUMBER NULL,
	EXPENSE_AMOUNT_USD	NUMBER NULL
)  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column CUSTOMER_NUMBER cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'CUSTOMER_NUMBER',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	CUSTOMER_NUMBER is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EMPLOYEE_ID cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'EMPLOYEE_ID',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	EMPLOYEE_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column FISCAL_PERIOD cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'FISCAL_PERIOD',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	FISCAL_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column GL_PERIOD cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'GL_PERIOD',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	GL_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column RUN_DATE cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'RUN_DATE',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	RUN_DATE is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","MAP_MAIN","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","L","L","SERIAL","EU","ORA_HYPGL_UNIT","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column DATA_SOURCE_ID cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'DATA_SOURCE_ID',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	DATA_SOURCE_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert CK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'AmortLife Must Be Positive',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'AmortLife Must be Positive',
	'CK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>  T_CAPC_DATALOAD
where	not 	(
		/* Date: 10/19/2021
Purpose: M&A Tableau Expense records will have EG_CUSTOMER_LIFE,TOTAL_CATCHUP_MONTHS,AMORT_LIFE is 0
T_CAPC_DATALOAD.EG_CUSTOMER_LIFE > T_CAPC_DATALOAD.TOTAL_CATCHUP_MONTHS
*/
T_CAPC_DATALOAD.EG_CUSTOMER_LIFE >= T_CAPC_DATALOAD.TOTAL_CATCHUP_MONTHS
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Drop flow table","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL",""," 
drop table <?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create check table","CKM Oracle","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	CATALOG_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	SCHEMA_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL ,
	RESOURCE_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	FULL_RES_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""100"") ?> NULL,
	ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL,
	ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL ,
	CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL,
	ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ERR_COUNT		<?=odiRef.getDataType(""DEST_NUMERIC"", ""10"") ?> NULL
)
	  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column COMMISSION_AMOUNT_USD cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'COMMISSION_AMOUNT_USD',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	COMMISSION_AMOUNT_USD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column AMORT_START_PERIOD cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'AMORT_START_PERIOD',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	AMORT_START_PERIOD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column PROCESS_ID cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'PROCESS_ID',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	PROCESS_ID is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUSINESS_UNIT cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'BUSINESS_UNIT',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	BUSINESS_UNIT is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column FISCAL_YEAR cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'FISCAL_YEAR',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	FISCAL_YEAR is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert check sum into check table","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""SNP_CHECK_TAB"", ""W"") ?>
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'<?=odiRef.getSchemaName(""ORA_HYPGL"", ""D"") ?>',
	'T_CAPC_DATALOAD',
	'<?= odiRef.getObjectName(""L"", ""T_CAPC_DATALOAD"", ""ORA_HYPGL"", ""D"") ?>',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?> E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete previous errors","CKM Oracle","","J","","ORA_HYPGL","","delete from 	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table')
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","Commit transaction","IKM SQL Control Append - FTI - SELECTIVE DELETE","","","","ORA_HYPGL","","/* commit */ "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column TOTAL_CATCHUP_MONTHS cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'TOTAL_CATCHUP_MONTHS',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	TOTAL_CATCHUP_MONTHS is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column BUYSELL_ENTITY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'BUYSELL_ENTITY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	BUYSELL_ENTITY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column VERSION cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'VERSION',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	VERSION is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create error table","CKM Oracle","","J","","ORA_HYPGL","","
create table <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_ROW_ID 		UROWID,
	ODI_ERR_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""1"") ?> NULL, 
	ODI_ERR_MESS		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CHECK_DATE	<?=odiRef.getDataType(""DEST_DATE"") ?> NULL, 
	FISCAL_YEAR	VARCHAR2(80) NULL,
	FISCAL_PERIOD	VARCHAR2(80) NULL,
	SCENARIO	VARCHAR2(80) NULL,
	VERSION	VARCHAR2(80) NULL,
	ENTITY	VARCHAR2(80) NULL,
	PCC	VARCHAR2(80) NULL,
	COSTCENTER	VARCHAR2(80) NULL,
	BUSINESS_UNIT	VARCHAR2(80) NULL,
	CUSTOMER_NUMBER	VARCHAR2(80) NULL,
	CUSTOMER_NAME	VARCHAR2(80) NULL,
	EMPLOYEE_ID	VARCHAR2(80) NULL,
	EARNINGS_GROUP	VARCHAR2(80) NULL,
	ROLE	VARCHAR2(80) NULL,
	ORDER_LINE_ID	VARCHAR2(80) NULL,
	HYP_LOAD_BATCH	VARCHAR2(80) NULL,
	BUYSELL_ENTITY	VARCHAR2(80) NULL,
	PAYMENT_CURRENCY	VARCHAR2(80) NULL,
	COMMISSION_AMOUNT_PAY_CURRENCY	NUMBER NULL,
	PAY_TO_BUYSELL_RATE	NUMBER NULL,
	BUYSELL_CURRENCY	VARCHAR2(80) NULL,
	COMMISSION_AMOUNT_BUYSELL_CURR	NUMBER NULL,
	PAY_TO_USD_RATE	NUMBER NULL,
	COMMISSION_AMOUNT_USD	NUMBER NULL,
	EG_CAPITAL_EXPENSE	VARCHAR2(15) NULL,
	EG_CUSTOMER_LIFE	VARCHAR2(15) NULL,
	TOTAL_CATCHUP_MONTHS	NUMBER NULL,
	AMORT_LIFE	NUMBER NULL,
	ORDER_CODE	VARCHAR2(50) NULL,
	CONTRACT_NUMBER	VARCHAR2(50) NULL,
	ORDER_START_DATE	VARCHAR2(15) NULL,
	ORDER_END_DATE	VARCHAR2(15) NULL,
	AMORT_START_PERIOD	VARCHAR2(15) NULL,
	ROLE_POOLED	VARCHAR2(20) NULL,
	PROCESS_ID	NUMBER NULL,
	GL_PERIOD	VARCHAR2(100) NULL,
	DATA_SOURCE_TYPE	VARCHAR2(100) NULL,
	DATA_SOURCE_ID	VARCHAR2(100) NULL,
	RUN_DATE	DATE NULL,
	EXPENSE_AMOUNT_PAY_CURRENCY	NUMBER NULL,
	EXPENSE_AMOUNT_BUYSELL_CURR	NUMBER NULL,
	EXPENSE_AMOUNT_USD	NUMBER NULL,
	DESCRIPTION	VARCHAR2(4000) NULL,
	ODI_ORIGIN		<?=odiRef.getDataType(""DEST_VARCHAR"", ""250"") ?> NULL,
	ODI_CONS_NAME	<?=odiRef.getDataType(""DEST_VARCHAR"", ""128"") ?> NULL,
	ODI_CONS_TYPE		<?=odiRef.getDataType(""DEST_VARCHAR"", ""2"") ?> NULL,
	ODI_PK			<?=odiRef.getDataType(""DEST_VARCHAR"", ""32"") ?> PRIMARY KEY,
	ODI_SESS_NO		<?=odiRef.getDataType(""DEST_VARCHAR"", ""36"") ?>
)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","create index on error table","CKM Oracle","","J","","ORA_HYPGL",""," 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
create index 	<?=odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD_IDX"", ""W"") ?> 
on	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?> (ODI_ROW_ID)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert FK errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15065: Join error (INVALID BusinessUnit) between the table T_CAPC_DATALOAD and the table V_CAPCOMMZ_BUSINESSUNIT.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'INVALID BusinessUnit',
	'FK',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?> T_CAPC_DATALOAD 
where 	(
		T_CAPC_DATALOAD.BUSINESS_UNIT 
	) not in 	(
		select 	CHILD
		from 	<?= odiRef.getObjectName(""L"", ""V_CAPCOMM_BUSINESSUNIT"", ""ORA_HYPGL"", ""D"") ?>
		)
and	(
		T_CAPC_DATALOAD.BUSINESS_UNIT is not null 
	)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","delete errors from controlled table","CKM Oracle","","J","","ORA_HYPGL","","delete from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>  T
where	exists 	(
		select	1
		from	<?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?> E
		where ODI_SESS_NO = '<?=odiRef.getSession(""SESS_GUID"") ?>'
		and T.rowid = E.ODI_ROW_ID
		)
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EXPENSE_AMOUNT_PAY_CURRENCY cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'EXPENSE_AMOUNT_PAY_CURRENCY',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	EXPENSE_AMOUNT_PAY_CURRENCY is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EXPENSE_AMOUNT_USD cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'EXPENSE_AMOUNT_USD',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	EXPENSE_AMOUNT_USD is null
  "
683,"CAPC_LOAD_XACTLY_DATA",43,"M","ORA Load Xactly Data to DataLoad Table","","ORA_HYPGL","","ORA_HYPGL","T_CAPC_DATALOAD","T_CAPC_DATALOAD","","41ec8bee-ebcc-40f3-8155-73cb3807f52b","<map-generation-info>
   <node name=""T_CAPC_DATALOAD"" type=""IKM"" km=""IKM SQL Control Append - FTI - SELECTIVE DELETE.Hyperion_Optimization"">
      <option name=""DELETE_CLAUSE"" value=""GL_PERIOD = '#EBS_PERIOD'&#xa;AND data_source_type = '#CAPC_DATA_SOURCE_TYPE'"" default=""false""/>
      <option name=""DELETE_SELECTIVE"" value=""true"" default=""true""/>
      <option name=""INSERT"" value=""true"" default=""true""/>
      <option name=""COMMIT"" value=""true"" default=""true""/>
      <option name=""FLOW_CONTROL"" value=""true"" default=""true""/>
      <option name=""RECYCLE_ERRORS"" value=""false"" default=""true""/>
      <option name=""STATIC_CONTROL"" value=""false"" default=""true""/>
      <option name=""TRUNCATE"" value=""false"" default=""true""/>
      <option name=""CREATE_TARG_TABLE"" value=""false"" default=""true""/>
      <option name=""DELETE_TEMPORARY_OBJECTS"" value=""true"" default=""true""/>
      <option name=""WRITE_TO_FILE"" value=""false"" default=""true""/>
   </node>
   <node name=""T_CAPC_DATALOAD"" type=""CKM"" km=""CKM Oracle.Hyperion_Optimization"">
      <option name=""DROP_ERROR_TABLE"" value=""true"" default=""false""/>
      <option name=""DROP_CHECK_TABLE"" value=""false"" default=""true""/>
      <option name=""CREATE_ERROR_INDEX"" value=""true"" default=""true""/>
      <option name=""CREATE_FLOW_INDEX"" value=""true"" default=""true""/>
      <option name=""COMPATIBLE"" value=""9"" default=""true""/>
      <option name=""VALIDATE"" value=""false"" default=""true""/>
      <option name=""ENABLE_EDITION_SUPPORT"" value=""false"" default=""true""/>
      <option name=""UPGRADE_ERROR_TABLE"" value=""false"" default=""true""/>
   </node>
   <node name=""AGG_STG"" type=""XKM"" km=""XKM SQL Aggregate.GLOBAL""/>
   <node name=""FILTER"" type=""XKM"" km=""XKM SQL Filter.GLOBAL""/>
   <node name=""T_CAPC_XACTLY_STG2"" type=""XKM"" km=""XKM Oracle Extract.GLOBAL"">
      <option name=""CUSTOM_TEMPLATE"" value="" "" default=""true""/>
      <option name=""SELECT_HINT"" value="" "" default=""true""/>
   </node>
   <target name=""T_CAPC_DATALOAD"" resource=""T_CAPC_DATALOAD"" model=""ORA_HYPGL"" logicalSchema=""ORA_HYPGL"" forcedContext=""""/>
</map-generation-info>","J","J","insert Not Null errors","CKM Oracle","","J","","ORA_HYPGL","","insert into <?= odiRef.getObjectName(""L"", ""%ERR_PRFT_CAPC_DATALOAD"", ""W"") ?>
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
)
select
	SYS_GUID(),
	'<?=odiRef.getSession(""SESS_GUID"") ?>', 
	rowid,
	'F', 
	'ODI-15066: The column EARNINGS_GROUP cannot be null.',
	sysdate,
	'(30)Hyperion_Optimization.ORA Load Xactly Data to DataLoad Table',
	'EARNINGS_GROUP',
	'NN',	
	FISCAL_YEAR,
	FISCAL_PERIOD,
	SCENARIO,
	VERSION,
	ENTITY,
	PCC,
	COSTCENTER,
	BUSINESS_UNIT,
	CUSTOMER_NUMBER,
	CUSTOMER_NAME,
	EMPLOYEE_ID,
	EARNINGS_GROUP,
	ROLE,
	ORDER_LINE_ID,
	HYP_LOAD_BATCH,
	BUYSELL_ENTITY,
	PAYMENT_CURRENCY,
	COMMISSION_AMOUNT_PAY_CURRENCY,
	PAY_TO_BUYSELL_RATE,
	BUYSELL_CURRENCY,
	COMMISSION_AMOUNT_BUYSELL_CURR,
	PAY_TO_USD_RATE,
	COMMISSION_AMOUNT_USD,
	EG_CAPITAL_EXPENSE,
	EG_CUSTOMER_LIFE,
	TOTAL_CATCHUP_MONTHS,
	AMORT_LIFE,
	ORDER_CODE,
	CONTRACT_NUMBER,
	ORDER_START_DATE,
	ORDER_END_DATE,
	AMORT_START_PERIOD,
	ROLE_POOLED,
	PROCESS_ID,
	GL_PERIOD,
	DATA_SOURCE_TYPE,
	DATA_SOURCE_ID,
	RUN_DATE,
	EXPENSE_AMOUNT_PAY_CURRENCY,
	EXPENSE_AMOUNT_BUYSELL_CURR,
	EXPENSE_AMOUNT_USD
from	<?= odiRef.getObjectName(""L"", ""%INT_PRFT_CAPC_DATALOAD"", ""W"") ?>
where	EARNINGS_GROUP is null
  "
683,"CAPC_LOAD_XACTLY_DATA",44,"T","Check Transfer to DataLoad","","","","","","","","ee7d5bf0-2460-4d82-9c29-c0ae2dda4a79","","S","S","Procedure","Check Processed Records","Capture Validation Detail","J","","ORA_EBS_SFDC_CAPCOM","","BEGIN

/*
INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, CAPITALIZED_SUMMARIZED)
SELECT DISTINCT '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' data_source_type, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID' data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, '#HYPERION_OPTIMIZATION.EBS_PERIOD' gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '7 - CapComm Load' process_step
, Count(*) CAPITALIZED_SUMMARIZED
FROM v_capcomm_fact
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO'
AND SubStr(currency, 1, 2) = 'P_';
*/

/*Date: 10/19/2021 Purpose: Count the Capitalized and Expense records into respective buckets*/

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, CAPITALIZED_SUMMARIZED,EXPENSE_SUMMARIZED)
SELECT DISTINCT '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' data_source_type, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID' data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, '#HYPERION_OPTIMIZATION.EBS_PERIOD' gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, 'lines' payment_currency, '7 - CapComm Load' process_step
, (Select count(*) from v_capcomm_fact WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD' AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO' AND EG_CUSTOMER_LIFE <> 0 AND SubStr(currency, 1, 2) = 'P_') CAPITALIZED_SUMMARIZED,
(Select count(*) from v_capcomm_fact WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD' AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO' AND EG_CUSTOMER_LIFE = 0 AND SubStr(currency, 1, 2) = 'P_') EXPENSE_SUMMARIZED
FROM v_capcomm_fact
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO'
AND SubStr(currency, 1, 2) = 'P_';

/*
INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, CAPITALIZED_SUMMARIZED,EXPENSE_SUMMARIZED, RENEWAL_ADVANCE_SUMMARIZED)
SELECT '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' data_source_type, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID' data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, '#HYPERION_OPTIMIZATION.EBS_PERIOD' gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(currency, -3) payment_currency, '7 - CapComm Load' process_step
, Sum(commission_amount) CAPITALIZED_SUMMARIZED, (Sum(commission_expense) - (SELECT NVL(Sum(commission_expense),0) FROM v_capcomm_fact 
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.CURR_JOB'
AND SubStr(currency, 1, 2) = 'P_'
AND EARNINGSGROUP like '%EG_RENEWALS_ADVANCE%')) EXPENSE_SUMMARIZED,  (SELECT NVL(Sum(commission_expense),0) FROM v_capcomm_fact 
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.CURR_JOB'
AND SubStr(currency, 1, 2) = 'P_'
AND EARNINGSGROUP like '%EG_RENEWALS_ADVANCE%') RENEWAL_ADVANCE_SUMMARIZED
FROM v_capcomm_fact
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO'
AND SubStr(currency, 1, 2) = 'P_'
GROUP BY SubStr(currency, -3);
*/

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, CAPITALIZED_SUMMARIZED,EXPENSE_SUMMARIZED,RENEWAL_ADVANCE_SUMMARIZED)
SELECT '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' data_source_type, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID' data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, '#HYPERION_OPTIMIZATION.EBS_PERIOD' gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(currency, -3) payment_currency, '7 - CapComm Load' process_step
, Sum(commission_amount) CAPITALIZED_SUMMARIZED, Sum(commission_expense) EXPENSE_SUMMARIZED,0 RENEWAL_ADVANCE_SUMMARIZED
FROM v_capcomm_fact
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO'
AND EARNINGSGROUP Not like '%EG_RENEWALS_ADVANCE%'
AND SubStr(currency, 1, 2) = 'P_'
GROUP BY SubStr(currency, -3);

INSERT INTO T_CAPC_AUDITS (DATA_SOURCE_TYPE, DATA_SOURCE_ID, SCENARIO, GL_PERIOD, ODI_PROCESS_ID, PAYMENT_CURRENCY, PROCESS_STEP, CAPITALIZED_SUMMARIZED,EXPENSE_SUMMARIZED,RENEWAL_ADVANCE_SUMMARIZED)
SELECT '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE' data_source_type, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID' data_source_id, '#HYPERION_OPTIMIZATION.SCENARIO' scenario, '#HYPERION_OPTIMIZATION.EBS_PERIOD' gl_period, '#HYPERION_OPTIMIZATION.CAPC_PROCESS_ID' process_id, SubStr(currency, -3) payment_currency, '7 - CapComm Load' process_step
, 0 CAPITALIZED_SUMMARIZED, 0 EXPENSE_SUMMARIZED, SUM(NVL(commission_expense,0)) RENEWAL_ADVANCE_SUMMARIZED
FROM v_capcomm_fact
WHERE year = '#HYPERION_OPTIMIZATION.HYP_YEAR' and timeperiod = '#HYPERION_OPTIMIZATION.HYP_PERIOD'
AND scenario = '#HYPERION_OPTIMIZATION.SCENARIO'
AND EARNINGSGROUP like '%EG_RENEWALS_ADVANCE%'
AND SubStr(currency, 1, 2) = 'P_'
GROUP BY SubStr(currency, -3);

EXCEPTION
    WHEN OTHERS THEN
        INSERT INTO t_capc_audits (gl_period, odi_process_id, data_source_type, scenario, status)
        VALUES ('#HYPERION_OPTIMIZATION.EBS_PERIOD', #HYPERION_OPTIMIZATION.CAPC_PROCESS_ID, '#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE', '#HYPERION_OPTIMIZATION.SCENARIO', '2 - ERROR: Validation Report is Invalid');

END;"
683,"CAPC_LOAD_XACTLY_DATA",44,"T","Check Transfer to DataLoad","","","","","","","","ee7d5bf0-2460-4d82-9c29-c0ae2dda4a79","","S","S","Procedure","Check Processed Records","Write Information to Audit File","B","","","","
blnCompleted = False
try:
	objAuditFile = None # need to create variable, needed below in case of failure to open
	objAuditFile = open( '#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE' , 'a' )
	objAuditFile.write(""Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>\n"")
	objAuditFile.write(""* StartTime: <?=odiRef.getPrevStepLog(""BEGIN"") ?>\n"")
	objAuditFile.write(""* EndTime: <?=odiRef.getPrevStepLog(""End"") ?>\n"")
	objAuditFile.write(""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) + ""\n"")


	objAuditFile.write(""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) + ""\n"")
	objAuditFile.write(""\n"")
	objAuditFile.write(""-   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -   -\n"")
	blnCompleted = True
finally:
	if not objAuditFile is None:
		objAuditFile.close()
	if not blnCompleted:
		raise Exception( ""\n\nError encountered with Audit file: #HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE\n"" )

"
683,"CAPC_LOAD_XACTLY_DATA",44,"T","Check Transfer to DataLoad","","","","","","","","ee7d5bf0-2460-4d82-9c29-c0ae2dda4a79","","S","S","Procedure","Check Processed Records","Check for Inserted Records","B","","","","if <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> > 0:
	print( ""Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Inserts: "" + str(<?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?>)
		+ ""\n\t(expected Number of Inserts > 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",44,"T","Check Transfer to DataLoad","","","","","","","","ee7d5bf0-2460-4d82-9c29-c0ae2dda4a79","","S","S","Procedure","Check Processed Records","Check for Error Records","B","","","","if <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> == 0:
	print( ""Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>) )
else:
	raise Exception(
		""ERROR: Number of Errors: "" + str(<?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?>)
		+ ""\n\t(expected Number of Errors == 0)"")"
683,"CAPC_LOAD_XACTLY_DATA",44,"T","Check Transfer to DataLoad","","","","","","","","ee7d5bf0-2460-4d82-9c29-c0ae2dda4a79","","S","S","Procedure","Check Processed Records","Set Stats","B","","","","odiRef.setNbInsert( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> )
odiRef.setNbDelete( <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> )
odiRef.setNbErrors( <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )
odiRef.setNbRows( <?=odiRef.getPrevStepLog(""INSERT_COUNT"") ?> + <?=odiRef.getPrevStepLog(""DELETE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""UPDATE_COUNT"") ?> + <?=odiRef.getPrevStepLog(""ERROR_COUNT"") ?> )"
683,"CAPC_LOAD_XACTLY_DATA",45,"SE","CAPC_CAPTURE_ADDED_AND_CHANGED_MEMBERS v1","","","","","","","","bbfd81f2-644c-4b05-8b12-c321ebfda8a8","","S","S","Oracle Data Integrator Command","Oracle Data Integrator Command","","S","","","","OdiStartScen ""-SCEN_NAME=CAPC_CAPTURE_ADDED_AND_CHANGED_MEMBERS"" ""-SCEN_VERSION=001"" ""-HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE=#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE"" ""-HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE=#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE"" ""-HYPERION_OPTIMIZATION.EBS_PERIOD=#HYPERION_OPTIMIZATION.EBS_PERIOD"""
683,"CAPC_LOAD_XACTLY_DATA",46,"VE","CAPC_ARCHIVE_SFTP_FILES = Y?","HYPERION_OPTIMIZATION.CAPC_ARCHIVE_SFTP_FILES","","Y","","","","","d6537e9d-481d-45b1-bd21-852fb621d016","","V","V","Variable","CAPC_ARCHIVE_SFTP_FILES","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",47,"T","Zip and Archive File","","","","","","","","22112b92-8783-4be6-8390-1837362344e5","","S","S","Procedure","Zip and Archive File","Get Date","J","","","","<?
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

DateFormat dateFormat = new SimpleDateFormat(""yyyyMMdd_HHmmss"");
Date date = new Date(); 
strTimestamp = dateFormat.format(date);
print(""Timestamp = "" + strTimestamp);
?>
SELECT '<?=strTimestamp?>' timestamp_for_archive_file FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",47,"T","Zip and Archive File","","","","","","","","22112b92-8783-4be6-8390-1837362344e5","","S","S","Procedure","Zip and Archive File","Move File to Zip Archive","S","","","","OdiZip ""-DIR=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>"" ""-FILE=#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID.*"" ""-TOFILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/../archive/#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID.<?=strTimestamp?>.zip"" ""-OVERWRITE=NO"" ""-RECURSE=YES"" ""-CASESENS=NO"""
683,"CAPC_LOAD_XACTLY_DATA",47,"T","Zip and Archive File","","","","","","","","22112b92-8783-4be6-8390-1837362344e5","","S","S","Procedure","Zip and Archive File","Delete Processed File","S","","","","OdiFileDelete ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_SFTP"", ""W"") ?>/#HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_ID.*"" ""-RECURSE=YES"" ""-CASESENS=NO"" ""-NOFILE_ERROR=YES"""
683,"CAPC_LOAD_XACTLY_DATA",48,"VE","CAPC_STATUS = Warning?","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","04d52dc2-8753-48a5-8f55-a1241bb4fe03","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",49,"SE","Send WARNING Email","","","","","","","","5a3e0517-22f4-47f3-8173-8494db3a30a8","","S","S","Oracle Data Integrator Command","Oracle Data Integrator Command","","S","","","","OdiSendMail ""-MAILHOST=#GLOBAL.SFDC_EMAIL_SERVER"" ""-FROM=#GLOBAL.SFDC_EMAIL_ADMIN"" ""-SUBJECT=ODI #HYPERION_OPTIMIZATION.CAPC_STATUS: <?=odiRef.getSession(""SESS_NAME"") ?> (SessionID: <?=odiRef.getSession(""SESS_NO"") ?>) - Context: <?=odiRef.getContext(""CTX_NAME"") ?>"" ""-TO=#GLOBAL.SFDC_EPM_EMAIL_LIST"" ""-ATTACH=#HYPERION_OPTIMIZATION.CAPCOMM_AUDIT_FILE"" ""-ATTACH=#HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS""
#HYPERION_OPTIMIZATION.CAPC_STATUS: the Xactly dataset contains invalid data. Please collaborate with the Commissions and/or Xactly team to resolve the issue.

Please contact the Xactly team if there is an error file name which contains ""INBOUND"".
For all other errors please contact the Commissions team.

Please see attachment for audit details:
1) DETAILED file: contains every individual error (this can contain more than 1 error record per source record)
     File path: #HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER\Errors\#HYPERION_OPTIMIZATION.INT_NAME\
     File Name:	
      #HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1
2) Xactly_errors_SUMMARY*.txt: contains summary by error type; the following files are attached: 
   #HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS"
683,"CAPC_LOAD_XACTLY_DATA",50,"VE","CAPC_DATA_SOURCE_TYPE != Xactly_Prelim_ALF_Comm?","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE","","Xactly_Prelim_ALF_Comm","","","","","24a28045-e73e-4f76-8aff-8aea60791f86","","V","V","Variable","CAPC_DATA_SOURCE_TYPE","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",51,"SE","Prelim ALF - Extract Report Data","","","","","","","","4bb79060-409e-44f7-8f59-d074da0c267c","","S","S","Oracle Data Integrator Command","Oracle Data Integrator Command","","S","","","","OdiOutFile ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\ADMIN_ONLY\queryFiles\CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.sql"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XROW_SEP=0D0A""
SELECT data.Fiscal_Year, data.Fiscal_Period, data.Version, data.Entity, data.PCC, data.CostCenter
, data.BusinessUnit, data.Customer, data.Employee, data.EarningsGroup, data.Role, data.OrderLineNo
, data.HypLoadBatch, data.Currency, data.SystemCurrency, data.Buysell_FX_Rate, data.EG_Customer_Life
, data.Total_Catchup_Months, data.Amort_Life, data.Order_Code, data.Contract_Number
, data.Order_Start_Date, data.Amort_Start_Period, data.Catchup_Calc, data.Commission_Amount,data.Commission_Expense
, data.Amortisation AS Amortization, data.ST AS ST, data.LT AS LT, PRSI.Driver_Value AS PRSI_Rate
, PRSI.driver_value * commission_amount AS PRSI_Capitalisation
, PRSI.driver_value * amortisation AS PRSI_Amortisation
, PRSI.driver_value * ST AS PRSI_ST
, PRSI.driver_value * LT AS PRSI_LT, null AS User_Comments
FROM
(
    SELECT year Fiscal_Year, timeperiod Fiscal_period, version, entity, pcc, costcenter, businessunit
    , customer, employee, earningsgroup, role, orderlineno, hyploadbatch, currency, systemcurrency
    , buysell_fx_rate, eg_customer_life, total_catchup_months, amort_life, order_code, contract_number
    , order_start_date, amort_start_period, catchup_calc, commission_amount
    /*EG_CUSTOMER_LIFE will be 0 for Expense Records
    , ((commission_amount/(eg_customer_life)) * (total_catchup_months-1)) amortisation
    , ((commission_amount/eg_customer_life)*(12 + (total_catchup_months-1))) ST
    , (commission_amount-((commission_amount/eg_customer_life)*(12 +(total_catchup_months-1)))) LT
    */
    ,(CASE WHEN eg_customer_life=0 THEN 0
      ELSE (commission_amount/(eg_customer_life)) * (total_catchup_months-1) 
      END ) amortisation
    ,(CASE WHEN eg_customer_life=0 THEN 0
      ELSE (commission_amount/eg_customer_life)*(12 + (total_catchup_months-1))
      END ) ST
    ,(CASE WHEN eg_customer_life=0 THEN 0
      ELSE commission_amount-((commission_amount/eg_customer_life)*(12 +(total_catchup_months-1)))
      END ) LT
      ,COMMISSION_EXPENSE
      FROM v_capcomm_fact
    WHERE year='#HYPERION_OPTIMIZATION.HYP_YEAR' AND timeperiod='#HYPERION_OPTIMIZATION.HYP_PERIOD'
) data
, (
    SELECT * FROM t_capc_drivers
    WHERE gl_period = '#HYPERION_OPTIMIZATION.EBS_PERIOD'
    AND account = 'PRSI_Rate'
) PRSI
WHERE data.entity = PRSI.entity"
683,"CAPC_LOAD_XACTLY_DATA",52,"T","Prelim ALF - Extract HYPGL Data To File","","","","","","","","df1e9852-bf8e-4dd8-a7d9-d31b56e9311b","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.sql'
strHeaderFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.sql_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",52,"T","Prelim ALF - Extract HYPGL Data To File","","","","","","","","df1e9852-bf8e-4dd8-a7d9-d31b56e9311b","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt.header.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.sql_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",52,"T","Prelim ALF - Extract HYPGL Data To File","","","","","","","","df1e9852-bf8e-4dd8-a7d9-d31b56e9311b","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",52,"T","Prelim ALF - Extract HYPGL Data To File","","","","","","","","df1e9852-bf8e-4dd8-a7d9-d31b56e9311b","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.sql"""
683,"CAPC_LOAD_XACTLY_DATA",52,"T","Prelim ALF - Extract HYPGL Data To File","","","","","","","","df1e9852-bf8e-4dd8-a7d9-d31b56e9311b","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt.*.txt"" ""-TOFILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/audit/Prelim Report/CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",53,"SE","Prelim ALF - Send SUCCESS Email","","","","","","","","5b59dd23-911e-4f46-b84e-a327acc58d3d","","S","S","Oracle Data Integrator Command","Oracle Data Integrator Command","","S","","","","OdiSendMail ""-MAILHOST=#GLOBAL.SFDC_EMAIL_SERVER"" ""-FROM=#GLOBAL.SFDC_EMAIL_ADMIN"" ""-SUBJECT=ODI Xactly Prelim ALF Extract: <?=odiRef.getSession(""SESS_NAME"") ?> (SessionID: <?=odiRef.getSession(""SESS_NO"") ?>) - Context: <?=odiRef.getContext(""CTX_NAME"") ?>"" ""-TO=#GLOBAL.SFDC_EPM_EMAIL_LIST""
Xactly - Preliminary ALF Extract

Please access the link below to the view the report (expected file size: 50+ MB):

<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\audit\Prelim Report\CapComm-Prelim-#HYPERION_OPTIMIZATION.EBS_PERIOD-#HYPERION_OPTIMIZATION.TIMESTAMP_SEC.txt"
683,"CAPC_LOAD_XACTLY_DATA",54,"T","Send UNEXPECTED ERROR Email","","","","","","","","ef7063de-fa15-46bb-99b3-924a3ac7df87","","S","S","Procedure","Send UNEXPECTED ERROR Email","Send ERROR Email","S","","","","OdiSendMail ""-MAILHOST=#GLOBAL.SFDC_EMAIL_SERVER"" ""-FROM=#GLOBAL.SFDC_EMAIL_ADMIN"" ""-SUBJECT=ODI UNEXPECTED ERROR: <?=odiRef.getSession(""SESS_NAME"") ?> (SessionID: <?=odiRef.getSession(""SESS_NO"") ?>) - Context: <?=odiRef.getContext(""CTX_NAME"") ?>"" ""-TO=#GLOBAL.SFDC_EPM_EMAIL_LIST"" ""-TO=#GLOBAL.SFDC_EPM_EMAIL_LIST_LTD"" ""-ATTACH=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\Errors\#HYPERION_OPTIMIZATION.INT_NAME\*_summary_*_<?=odiRef.getSession(""SESS_NO"") ?>.txt""
An Unexpected Error occurred when processing the dataset for #HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE. Please review the ODI Operator logs.

ODI Error Information
=====================

Error Step: <?=odiRef.getPrevStepLog(""STEP_NAME"") ?>



Error Message: <?=odiRef.getPrevStepLog(""MESSAGE"") ?>"
683,"CAPC_LOAD_XACTLY_DATA",54,"T","Send UNEXPECTED ERROR Email","","","","","","","","ef7063de-fa15-46bb-99b3-924a3ac7df87","","S","S","Procedure","Send UNEXPECTED ERROR Email","Raise Error after Notification","B","","","","raise Exception(""\n\nSent Unexpected Error Email - set Process Status to ERROR\n"")"
683,"CAPC_LOAD_XACTLY_DATA",55,"VS","Set INT_NAME_POSTFIX = _DATALOAD","HYPERION_OPTIMIZATION.INT_NAME_POSTFIX","","_DATALOAD","","","","","b498b5e1-be9d-47d7-994b-ca6ded1af6f6","","V","V","Variable","INT_NAME_POSTFIX","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",56,"V","CAPC_ERROR_FILE_DETAILED_V1","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1","","","","","","","b0b89bd3-c66b-41b8-8f1c-48e2935ad5cb","","V","V","Variable","CAPC_ERROR_FILE_DETAILED_V1","","","","","","SELECT Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",57,"V","CAPC_ERROR_FILE_DETAILED","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED","","","","","","","701d4109-5c72-4aa0-8b2f-2bc59db9e9b9","","V","V","Variable","CAPC_ERROR_FILE_DETAILED","","","","","","SELECT '#HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER/Errors/#HYPERION_OPTIMIZATION.INT_NAME/' || Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",58,"V","Refresh CAPC_ERROR_FILE_SUMMARY","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY","","","","","","","26e06fbd-fba5-449f-9189-549034fbd86b","","V","V","Variable","CAPC_ERROR_FILE_SUMMARY","","","","","","SELECT Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED' , '_errors_detailed_' , '_errors_summary_' ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",59,"T","Extract DataLoad Detailed Error Information","","","","","","","","32bbc17b-68dc-4ffb-b41e-9dba7976b2bd","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_detailed.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_detailed.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",59,"T","Extract DataLoad Detailed Error Information","","","","","","","","32bbc17b-68dc-4ffb-b41e-9dba7976b2bd","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_detailed.txt"""
683,"CAPC_LOAD_XACTLY_DATA",59,"T","Extract DataLoad Detailed Error Information","","","","","","","","32bbc17b-68dc-4ffb-b41e-9dba7976b2bd","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",59,"T","Extract DataLoad Detailed Error Information","","","","","","","","32bbc17b-68dc-4ffb-b41e-9dba7976b2bd","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_detailed.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",59,"T","Extract DataLoad Detailed Error Information","","","","","","","","32bbc17b-68dc-4ffb-b41e-9dba7976b2bd","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",60,"T","Extract DataLoad Summary Error Information","","","","","","","","5687986c-8d3e-4a81-b117-4e8c7dd2c1a7","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_summary.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_summary.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",60,"T","Extract DataLoad Summary Error Information","","","","","","","","5687986c-8d3e-4a81-b117-4e8c7dd2c1a7","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_summary.txt"""
683,"CAPC_LOAD_XACTLY_DATA",60,"T","Extract DataLoad Summary Error Information","","","","","","","","5687986c-8d3e-4a81-b117-4e8c7dd2c1a7","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",60,"T","Extract DataLoad Summary Error Information","","","","","","","","5687986c-8d3e-4a81-b117-4e8c7dd2c1a7","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/DATALOAD_Errors_SQL_summary.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",60,"T","Extract DataLoad Summary Error Information","","","","","","","","5687986c-8d3e-4a81-b117-4e8c7dd2c1a7","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",61,"VS","Set CAPC_STATUS = Warning","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","4084831e-a321-4c50-9c0d-b6d8a1e51c1a","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",62,"V","CAPC_EMAIL_ATTACHMENTS","HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS","","","","","","","f4892021-73c3-4060-bc57-7a934983a525","","V","V","Variable","CAPC_EMAIL_ATTACHMENTS","","","","","","/* SELECT CASE
    WHEN Trim( 'CAPC_EMAIL_ATTACHMENT' ) IS NULL THEN ''
    ELSE 'CAPC_EMAIL_ATTACHMENT,' 
END || 'CAPC_ERROR_FILE_SUMMARY'
FROM dual*/

SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\Errors\#HYPERION_OPTIMIZATION.INT_NAME\*_summary_*_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",63,"V","CAPC_EMAIL_LINKS_V1","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1","","","","","","","98731960-da49-470e-ba84-b6d3f6450fe5","","V","V","Variable","CAPC_EMAIL_LINKS_V1","","","","","","SELECT replace(CASE
    WHEN Trim( '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' ) IS NULL THEN ''
    ELSE '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' || CHR(10)
END || Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1' , '/' , '\' ), '_V1', '')
FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",64,"VS","Set INT_NAME_POSTFIX = _STG2","HYPERION_OPTIMIZATION.INT_NAME_POSTFIX","","_STG2","","","","","300e4305-f378-4086-a67b-516fc4bd59ce","","V","V","Variable","INT_NAME_POSTFIX","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",65,"V","CAPC_ERROR_FILE_DETAILED_V1","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1","","","","","","","67252e88-ed8b-4f14-b506-92fb4ad37126","","V","V","Variable","CAPC_ERROR_FILE_DETAILED_V1","","","","","","SELECT Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",66,"V","CAPC_ERROR_FILE_DETAILED","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED","","","","","","","495f96d6-e83e-4a3a-ade4-3ed79c0d7777","","V","V","Variable","CAPC_ERROR_FILE_DETAILED","","","","","","SELECT '#HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER/Errors/#HYPERION_OPTIMIZATION.INT_NAME/' || Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",67,"V","Refresh CAPC_ERROR_FILE_SUMMARY","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY","","","","","","","94730e0f-1377-4acb-bbb2-25adb3b4a398","","V","V","Variable","CAPC_ERROR_FILE_SUMMARY","","","","","","SELECT Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED' , '_errors_detailed_' , '_errors_summary_' ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",68,"T","Extract STG2 Detailed Error Information","","","","","","","","206188a2-2a06-4073-b278-e2e00c6bb369","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_detailed.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_detailed.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",68,"T","Extract STG2 Detailed Error Information","","","","","","","","206188a2-2a06-4073-b278-e2e00c6bb369","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_detailed.txt"""
683,"CAPC_LOAD_XACTLY_DATA",68,"T","Extract STG2 Detailed Error Information","","","","","","","","206188a2-2a06-4073-b278-e2e00c6bb369","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",68,"T","Extract STG2 Detailed Error Information","","","","","","","","206188a2-2a06-4073-b278-e2e00c6bb369","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_detailed.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",68,"T","Extract STG2 Detailed Error Information","","","","","","","","206188a2-2a06-4073-b278-e2e00c6bb369","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",69,"T","Extract STG2 Summary Error Information","","","","","","","","981fbce5-502c-4429-9b40-e7da121c96c0","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_summary.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",69,"T","Extract STG2 Summary Error Information","","","","","","","","981fbce5-502c-4429-9b40-e7da121c96c0","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",69,"T","Extract STG2 Summary Error Information","","","","","","","","981fbce5-502c-4429-9b40-e7da121c96c0","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_summary.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_summary.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",69,"T","Extract STG2 Summary Error Information","","","","","","","","981fbce5-502c-4429-9b40-e7da121c96c0","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG2_Errors_SQL_summary.txt"""
683,"CAPC_LOAD_XACTLY_DATA",69,"T","Extract STG2 Summary Error Information","","","","","","","","981fbce5-502c-4429-9b40-e7da121c96c0","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",70,"VS","Set CAPC_STATUS = Warning","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","c9ca83d3-6a43-4f15-918e-ddbb9f0e3204","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",71,"V","CAPC_EMAIL_ATTACHMENTS","HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS","","","","","","","d2fcf509-d3ff-4817-b382-a53753dbe8b2","","V","V","Variable","CAPC_EMAIL_ATTACHMENTS","","","","","","/* SELECT CASE
    WHEN Trim( 'CAPC_EMAIL_ATTACHMENT' ) IS NULL THEN ''
    ELSE 'CAPC_EMAIL_ATTACHMENT,' 
END || 'CAPC_ERROR_FILE_SUMMARY'
FROM dual*/

SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\Errors\#HYPERION_OPTIMIZATION.INT_NAME\*_summary_*_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",72,"V","CAPC_EMAIL_LINKS_V1","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1","","","","","","","fab693d4-7b60-4911-96f0-c045997010d2","","V","V","Variable","CAPC_EMAIL_LINKS_V1","","","","","","SELECT replace(CASE
    WHEN Trim( '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' ) IS NULL THEN ''
    ELSE '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' || CHR(10)
END || Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1' , '/' , '\' ), '_V1', '')
FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",73,"VS","Set CAPC_STATUS = Warning","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","c6f312a2-a1fb-47f5-8cc6-d40ede91d7d9","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",74,"VS","Set INT_NAME_POSTFIX = _STG1","HYPERION_OPTIMIZATION.INT_NAME_POSTFIX","","_STG1","","","","","778b7da0-eabd-4ee9-9747-2054e438b5ec","","V","V","Variable","INT_NAME_POSTFIX","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",75,"V","CAPC_ERROR_FILE_DETAILED_V1","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1","","","","","","","97f76bc8-9419-4f0f-b0f0-a0ec2846179d","","V","V","Variable","CAPC_ERROR_FILE_DETAILED_V1","","","","","","SELECT Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",76,"V","CAPC_ERROR_FILE_DETAILED","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED","","","","","","","7844fcdf-fa6e-45d5-9b55-625905c91a6c","","V","V","Variable","CAPC_ERROR_FILE_DETAILED","","","","","","SELECT '#HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER/Errors/#HYPERION_OPTIMIZATION.INT_NAME/' || Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",77,"V","Refresh CAPC_ERROR_FILE_SUMMARY","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY","","","","","","","5c295145-fb55-4668-9ad3-f2a640158928","","V","V","Variable","CAPC_ERROR_FILE_SUMMARY","","","","","","SELECT Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED' , '_errors_detailed_' , '_errors_summary_' ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",78,"T","Extract STG1 Detailed Error Information","","","","","","","","ee9a44b9-02b6-4bbd-897c-b6e3c77b8f55","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",78,"T","Extract STG1 Detailed Error Information","","","","","","","","ee9a44b9-02b6-4bbd-897c-b6e3c77b8f55","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_detailed.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_detailed.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",78,"T","Extract STG1 Detailed Error Information","","","","","","","","ee9a44b9-02b6-4bbd-897c-b6e3c77b8f55","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_detailed.txt"""
683,"CAPC_LOAD_XACTLY_DATA",78,"T","Extract STG1 Detailed Error Information","","","","","","","","ee9a44b9-02b6-4bbd-897c-b6e3c77b8f55","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",78,"T","Extract STG1 Detailed Error Information","","","","","","","","ee9a44b9-02b6-4bbd-897c-b6e3c77b8f55","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_detailed.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",79,"T","Extract STG1 Summary Error Information","","","","","","","","3943f04f-e647-4df3-becc-046dec36a32b","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_summary.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_summary.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",79,"T","Extract STG1 Summary Error Information","","","","","","","","3943f04f-e647-4df3-becc-046dec36a32b","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_summary.txt"""
683,"CAPC_LOAD_XACTLY_DATA",79,"T","Extract STG1 Summary Error Information","","","","","","","","3943f04f-e647-4df3-becc-046dec36a32b","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",79,"T","Extract STG1 Summary Error Information","","","","","","","","3943f04f-e647-4df3-becc-046dec36a32b","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_STG1_Errors_SQL_summary.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",79,"T","Extract STG1 Summary Error Information","","","","","","","","3943f04f-e647-4df3-becc-046dec36a32b","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",80,"VS","Set CAPC_STATUS = Warning","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","0490e2e1-c6dd-4a79-a952-4a9ee130424c","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",81,"V","CAPC_EMAIL_ATTACHMENTS","HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS","","","","","","","8abcae36-104a-4a17-a73c-88fb704a6d36","","V","V","Variable","CAPC_EMAIL_ATTACHMENTS","","","","","","/* SELECT CASE
    WHEN Trim( 'CAPC_EMAIL_ATTACHMENT' ) IS NULL THEN ''
    ELSE 'CAPC_EMAIL_ATTACHMENT,' 
END || 'CAPC_ERROR_FILE_SUMMARY'
FROM dual*/

SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\Errors\#HYPERION_OPTIMIZATION.INT_NAME\*_summary_*_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",82,"V","CAPC_EMAIL_LINKS_V1","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1","","","","","","","d7a69711-7669-4cb2-ae04-a30df67a6ea3","","V","V","Variable","CAPC_EMAIL_LINKS_V1","","","","","","SELECT replace(CASE
    WHEN Trim( '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' ) IS NULL THEN ''
    ELSE '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' || CHR(10)
END || Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1' , '/' , '\' ), '_V1', '')
FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",83,"VS","Set INT_NAME_POSTFIX = _INBOUND","HYPERION_OPTIMIZATION.INT_NAME_POSTFIX","","_INBOUND","","","","","5fdb0b2e-5302-4e58-9d3d-f6f0bc0808ff","","V","V","Variable","INT_NAME_POSTFIX","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",84,"V","CAPC_ERROR_FILE_DETAILED_V1","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1","","","","","","","f94774d7-fd9a-4c10-b75f-977ee2e805c5","","V","V","Variable","CAPC_ERROR_FILE_DETAILED_V1","","","","","","SELECT Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",85,"V","CAPC_ERROR_FILE_DETAILED","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED","","","","","","","d8b4a8f8-bf8c-4bce-933d-a11910d0975a","","V","V","Variable","CAPC_ERROR_FILE_DETAILED","","","","","","SELECT '#HYPERION_OPTIMIZATION.CAPCOMM_ROOT_FOLDER/Errors/#HYPERION_OPTIMIZATION.INT_NAME/' || Lower('#HYPERION_OPTIMIZATION.INT_NAME') || Lower( Trim( '#HYPERION_OPTIMIZATION.INT_NAME_POSTFIX' ) ) ||  '_errors_detailed_#HYPERION_OPTIMIZATION.EBS_PERIOD' || '_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",86,"V","Refresh CAPC_ERROR_FILE_SUMMARY","HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY","","","","","","","204f8154-149a-44ec-b5d0-09a32ef93c2d","","V","V","Variable","CAPC_ERROR_FILE_SUMMARY","","","","","","SELECT Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED' , '_errors_detailed_' , '_errors_summary_' ) FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",87,"T","Extract Inbound Detailed Error Information","","","","","","","","cb398b04-5314-436f-867b-3c76f3f0f1ce","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_detailed.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_detailed.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",87,"T","Extract Inbound Detailed Error Information","","","","","","","","cb398b04-5314-436f-867b-3c76f3f0f1ce","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_detailed.txt"""
683,"CAPC_LOAD_XACTLY_DATA",87,"T","Extract Inbound Detailed Error Information","","","","","","","","cb398b04-5314-436f-867b-3c76f3f0f1ce","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",87,"T","Extract Inbound Detailed Error Information","","","","","","","","cb398b04-5314-436f-867b-3c76f3f0f1ce","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_detailed.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",87,"T","Extract Inbound Detailed Error Information","","","","","","","","cb398b04-5314-436f-867b-3c76f3f0f1ce","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",88,"T","Extract Inbound Summary Error Information","","","","","","","","4f494e23-eefa-45a7-bae5-2eb54c4a4c79","","S","S","Procedure","Extract HYPGL Data To File","Extract HYPGL Data To File","S","","ORA_HYPGL","","OdiSqlUnload ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"" ""-DRIVER=<?=odiRef.getInfo(""SRC_JAVA_DRIVER"") ?>"" ""-URL=<?=odiRef.getInfo(""SRC_JAVA_URL"") ?>"" ""-USER=<?=odiRef.getInfo(""SRC_USER_NAME"") ?>"" ""-PASS=<?=odiRef.getInfo(""SRC_ENCODED_PASS"") ?>"" ""-FILE_FORMAT=VARIABLE"" ""-FIELD_SEP=	"" ""-ROW_SEP=\r\n"" ""-DATE_FORMAT=yyyy/MM/dd"" ""-CHARSET_ENCODING=ISO8859_1"" ""-XML_CHARSET_ENCODING=ISO-8859-1"" ""-QUERY_FILE=<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_summary.txt"""
683,"CAPC_LOAD_XACTLY_DATA",88,"T","Extract Inbound Summary Error Information","","","","","","","","4f494e23-eefa-45a7-bae5-2eb54c4a4c79","","S","S","Procedure","Extract HYPGL Data To File","Merge Files","S","","","","OdiFileAppend ""-FILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.*.txt"" ""-TOFILE=#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY"" ""-CASESENS=NO"" ""-OVERWRITE=NO"""
683,"CAPC_LOAD_XACTLY_DATA",88,"T","Extract Inbound Summary Error Information","","","","","","","","4f494e23-eefa-45a7-bae5-2eb54c4a4c79","","S","S","Procedure","Extract HYPGL Data To File","Delete Header and Output files","B","","","","import os
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt"")
os.remove(""#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.output.txt"")
os.remove(""<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_summary.txt_debug.txt"")"
683,"CAPC_LOAD_XACTLY_DATA",88,"T","Extract Inbound Summary Error Information","","","","","","","","4f494e23-eefa-45a7-bae5-2eb54c4a4c79","","S","S","Procedure","Extract HYPGL Data To File","Set Dummy Insert Count","J","","","",""
683,"CAPC_LOAD_XACTLY_DATA",88,"T","Extract Inbound Summary Error Information","","","","","","","","4f494e23-eefa-45a7-bae5-2eb54c4a4c79","","S","S","Procedure","Extract HYPGL Data To File","Get Column Names for SQL File","B","","","","# define path of query file
strQueryFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_summary.txt'
strHeaderFile = '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_SUMMARY.header.txt'
strDelimiter = '\t'


def removeTextBetweenTags(strColumnList, strStartTag, strEndTag):
# remove any characters between start/end tags from the ColumnList
    intStartPos  = 0
    intEndPos  = 0
    intStartPos2 = 0 # new
    while True:
        if strStartTag in strColumnList:
            intStartPos = strColumnList.find( strStartTag )
            intStartPos2 = strColumnList.find( strStartTag , intStartPos + 1 )
            intEndPos = strColumnList.find( strEndTag )
            # intEndPos2 = strColumnList.find( strEndTag , intEndPos + 1)
            while intStartPos2 > intStartPos and intStartPos2 < intEndPos:
                intStartPos2 = strColumnList.find( strStartTag , intStartPos2 + 1 )
                intEndPos = strColumnList.find( strEndTag , intEndPos + 1)    
            intEndPos += 2
            strColumnList = strColumnList[:intStartPos] + strColumnList[intEndPos:]
        else:
            return strColumnList



# initialize position variables and columnList
intColumnsStartPos = 0
intColumnsEndPos = 0
strColumnList = """"
strColumnHeader = """"
blnFoundSELECT = False
blnFoundFROM = False

# open query file
objQueryFile = open( strQueryFile , 'r' )

strDebugFile = '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""W"") ?>/ADMIN_ONLY/queryFiles/Xactly_INBOUND_Errors_SQL_summary.txt_debug.txt'
objDebugFile = open( strDebugFile , 'w' )
# DEBUG ONLY: objDebugFile = open( strDebugFile , 'w' )
objDebugFile.write(""Writing data to files:\n"" + strDebugFile + ""\n"" + strHeaderFile)

# DEBUG ONLY: objDebugFile.write(""Start Debugging"")
# loop through query file
for strLine in objQueryFile:
# DEBUG ONLY:     objDebugFile.write(""line="" + strLine)

    # NEW: replace all line breaks with a space
    strLine = "" "" + strLine

    # if line contains 'SELECT' then trim the line so it does not include the word SELECT
    if ""SELECT"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found SELECT"")
        intColumnStartPos = strLine.find(""SELECT "") + 7
        strLine = strLine[intColumnStartPos:]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundSELECT = True

    # if the line contains FROM then trim the line so that it contains everything up to the word FROM
    if ""FROM"" in strLine.upper():
# DEBUG ONLY:         objDebugFile.write(""Found FROM"")
        intColumnEndPos = strLine.find("" FROM "")
        strLine = strLine[:intColumnEndPos]
# DEBUG ONLY:         objDebugFile.write(""line="" + strLine)
        blnFoundFROM = True

    if blnFoundSELECT == True:
        # remove any single line columns
        if ""--"" in strLine:
            intCommentPos = strLine.find(""--"")
            strLine = strLine[:intCommentPos - 1]
        strColumnList += strLine

    if blnFoundFROM == True:
        break

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumnList)
objDebugFile.write(""ColumnList BEFORE CleanUp="" + strColumnList)
# remove any multi-line comments from the ColumnList
strColumnList = removeTextBetweenTags(strColumnList, ""/*"", ""*/"")

objDebugFile.write(""ColumnList After Comment CleanUp="" + strColumnList)
# remove any content that is inside of parentheses
strColumnList = removeTextBetweenTags(strColumnList, ""("", "")"")
objDebugFile.write(""ColumnList After Parentheses CleanUp="" + strColumnList)

# DEBUG ONLY: objDebugFile.write(""strColumnList="" + strColumnList)
# split column list into fields, delimited by comma
arrColumns = strColumnList.split("","")
for strColumn in arrColumns:
    # remove any leading or trailing spaces
    strColumn = strColumn.strip()
    # Two checks are needed to determine the alias/column name
    # 1) if the column has an alias, use the alias only
    # 2) if the column contains no alias but a dot to qualify the column with its table name, use the column name only

    # the logic can be implemented like this: 
    # 1) split column name by ""space"" and use the last element
    arrColumnInfo = strColumn.split("" "")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]
    # 2) split the column name by ""."" and use the last element; either it will be the alias or the column name then
    arrColumnInfo = strColumn.split(""."")
    strColumn = arrColumnInfo[ len(arrColumnInfo) - 1 ]

# DEBUG ONLY:     objDebugFile.write(""Column="" + strColumn)
    if strColumnHeader != """":
        strColumnHeader += strDelimiter
    strColumnHeader += strColumn

# DEBUG ONLY: objDebugFile.write(""Final ColumnList="" + strColumn)

# open header file and write column headers
objHeaderFile = open( strHeaderFile , 'w' )
objHeaderFile.write(strColumnHeader + ""\n"")

objQueryFile.close()
objHeaderFile.close()
objDebugFile.close()"
683,"CAPC_LOAD_XACTLY_DATA",89,"VS","Set CAPC_STATUS = Warning","HYPERION_OPTIMIZATION.CAPC_STATUS","","WARNING","","","","","92976f7f-6c30-4001-8d70-18f64ac431d9","","V","V","Variable","CAPC_STATUS","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",90,"V","CAPC_EMAIL_ATTACHMENTS","HYPERION_OPTIMIZATION.CAPC_EMAIL_ATTACHMENTS","","","","","","","e5ea7e4d-c1b4-476f-9e1c-d9b0ab81af8e","","V","V","Variable","CAPC_EMAIL_ATTACHMENTS","","","","","","/* SELECT CASE
    WHEN Trim( 'CAPC_EMAIL_ATTACHMENT' ) IS NULL THEN ''
    ELSE 'CAPC_EMAIL_ATTACHMENT,' 
END || 'CAPC_ERROR_FILE_SUMMARY'
FROM dual*/

SELECT '<?=odiRef.getSchemaName(""FILE_CAPCOMM_ROOT"", ""D"") ?>\Errors\#HYPERION_OPTIMIZATION.INT_NAME\*_summary_*_<?=odiRef.getSession(""SESS_NO"") ?>.txt' FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",91,"V","CAPC_EMAIL_LINKS_V1","HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1","","","","","","","2125793a-de77-4fc5-a06b-99870a4c80db","","V","V","Variable","CAPC_EMAIL_LINKS_V1","","","","","","SELECT replace(CASE
    WHEN Trim( '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' ) IS NULL THEN ''
    ELSE '#HYPERION_OPTIMIZATION.CAPC_EMAIL_LINKS_V1' || CHR(10)
END || Replace( '#HYPERION_OPTIMIZATION.CAPC_ERROR_FILE_DETAILED_V1' , '/' , '\' ), '_V1', '')
FROM dual"
683,"CAPC_LOAD_XACTLY_DATA",92,"VE","Is PPP = N? (i.e. Final - Comm)","HYPERION_OPTIMIZATION.CAPC_IS_PPP","","N","","","","","11ec484a-d5fb-4c5f-8833-615e15275d53","","V","V","Variable","CAPC_IS_PPP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",93,"VS","Set CAPC_DATA_SOURCE_TYPE = FINAL+Comm","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE","","Xactly_Final_ALF_Comm","","","","","7aaa2fba-e7e4-43a3-b0ee-5b040603268e","","V","V","Variable","CAPC_DATA_SOURCE_TYPE","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",94,"VE","Is Final = N? (i.e. Prelim)","HYPERION_OPTIMIZATION.CAPC_IS_FINAL","","N","","","","","80124e0e-b18d-4795-8573-7f7f71209f86","","V","V","Variable","CAPC_IS_FINAL","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",95,"VE","Is PPP = Y? (i.e. Prelim - PPP)","HYPERION_OPTIMIZATION.CAPC_IS_PPP","","Y","","","","","2dea6468-20e8-468d-b71f-566d67075e2d","","V","V","Variable","CAPC_IS_PPP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",96,"VS","Set CAPC_DATA_SOURCE_TYPE = PRELIM+PPP","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE","","Xactly_Prelim_ALF_PPP","","","","","f1e4c928-fe1e-4f81-97cc-8f7b0898806d","","V","V","Variable","CAPC_DATA_SOURCE_TYPE","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",97,"VE","Is PPP = N? (i.e. Prelim - Comm)","HYPERION_OPTIMIZATION.CAPC_IS_PPP","","N","","","","","99e29e73-a40c-4775-aa20-9ec2b069cbf0","","V","V","Variable","CAPC_IS_PPP","","","","","",""
683,"CAPC_LOAD_XACTLY_DATA",98,"VS","Set CAPC_DATA_SOURCE_TYPE = PRELIM+Comm","HYPERION_OPTIMIZATION.CAPC_DATA_SOURCE_TYPE","","Xactly_Prelim_ALF_Comm","","","","","34fcc471-16a0-4a79-8eba-ea0c6f2527f1","","V","V","Variable","CAPC_DATA_SOURCE_TYPE","","","","","",""
